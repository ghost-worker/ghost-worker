{"version":3,"file":null,"sources":["../lib/utils.js","../lib/dom/messaging.js","../node_modules/morphdom/src/index.js","../lib/dom/index.js"],"sourcesContent":["'use strict';\n\nfunction removeLastBackslash( path ){\n    return (endsWith(path , '/'))? path.slice(0, -1) : path;\n}\n\n\nfunction urlJoinPath( url, path ){\n    url = new URL( url );\n    url.pathname = url.pathname + path\n    return url.toString();\n}\n\n\nfunction urlReplacePath( url, path ){\n    url = new URL( url );\n    url.pathname = path\n    return url.toString();\n}\n\n\nfunction urlRemoveBackslash( url ){\n    url = new URL( url );\n    if(endsWith(url.pathname, '/')){\n      url.pathname = url.pathname.slice(0, -1);\n    }\n    return url.toString();\n}\n\n\nfunction endsWith(str, match, position) {\n  if (typeof position !== 'number' || !isFinite(position) || Math.floor(position) !== position || position > str.length) {\n    position = str.length;\n  }\n  position -= match.length;\n  var lastIndex = str.lastIndexOf(match, position);\n  return lastIndex !== -1 && lastIndex === position;\n}\n\n\nfunction clone(obj){\n    // very simple clone, be careful\n    return JSON.parse(JSON.stringify(obj))\n}\n\n\n// handles fetch errs\nfunction handleErrors(response) {\n    if (!response.ok) {\n        throw Error(response.statusText);\n    }\n    return response;\n}\n\n\nmodule.exports = {\n    removeLastBackslash,\n    urlJoinPath,\n    urlReplacePath,\n    urlRemoveBackslash,\n    endsWith,\n    clone,\n    handleErrors\n};\n","'use strict';\n\nfunction getDataFromSW(requestOptions) {\n    // This wraps the message posting/response in a promise, which will resolve if the response doesn't\n    // contain an error, and reject with the error if it does. If you'd prefer, it's possible to call\n    // controller.postMessage() and set up the onmessage handler independently of a promise, but this is\n    // a convenient wrapper.\n    return new Promise(function (resolve, reject) {\n        let messageChannel = new MessageChannel();\n        messageChannel.port1.onmessage = function (event) {\n            if (event.data.error) {\n                reject(event.data.error);\n            } else {\n                resolve(event.data);\n            }\n        };\n\n        // This sends the message data as well as transferring messageChannel.port2 to the service worker.\n        // The service worker can then use the transferred port to reply via postMessage(), which\n        // will in turn trigger the onmessage handler on messageChannel.port1.\n        // See https://html.spec.whatwg.org/multipage/workers.html#dom-worker-postmessage\n        navigator.serviceWorker.controller.postMessage(requestOptions, [messageChannel.port2]);\n    });\n}\n\n\nfunction getRouteData(url) {\n\n    return getDataFromSW({ 'command': 'getRouteData', 'url': url })\n        .then(function (response) {\n            return response.result;\n        }).catch(function (reason) {\n            console.log(reason);\n        });\n}\n\n\nfunction getSiteData() {\n\n    return getDataFromSW({ 'command': 'getSiteData' })\n        .then(function (response) {\n            return response.result;\n        }).catch(function (reason) {\n            console.log(reason);\n        });\n}\n\n\nmodule.exports = {\n    getRouteData,\n    getSiteData\n};\n","'use strict';\n// Create a range object for efficently rendering strings to elements.\nvar range;\n\nvar doc = typeof document !== 'undefined' && document;\n\nvar testEl = doc ?\n    doc.body || doc.createElement('div') :\n    {};\n\nvar NS_XHTML = 'http://www.w3.org/1999/xhtml';\n\nvar ELEMENT_NODE = 1;\nvar TEXT_NODE = 3;\nvar COMMENT_NODE = 8;\n\n// Fixes <https://github.com/patrick-steele-idem/morphdom/issues/32>\n// (IE7+ support) <=IE7 does not support el.hasAttribute(name)\nvar hasAttributeNS;\n\nif (testEl.hasAttributeNS) {\n    hasAttributeNS = function(el, namespaceURI, name) {\n        return el.hasAttributeNS(namespaceURI, name);\n    };\n} else if (testEl.hasAttribute) {\n    hasAttributeNS = function(el, namespaceURI, name) {\n        return el.hasAttribute(name);\n    };\n} else {\n    hasAttributeNS = function(el, namespaceURI, name) {\n        return !!el.getAttributeNode(name);\n    };\n}\n\nfunction toElement(str) {\n    if (!range && doc.createRange) {\n        range = doc.createRange();\n        range.selectNode(doc.body);\n    }\n\n    var fragment;\n    if (range && range.createContextualFragment) {\n        fragment = range.createContextualFragment(str);\n    } else {\n        fragment = doc.createElement('body');\n        fragment.innerHTML = str;\n    }\n    return fragment.childNodes[0];\n}\n\nfunction syncBooleanAttrProp(fromEl, toEl, name) {\n    if (fromEl[name] !== toEl[name]) {\n        fromEl[name] = toEl[name];\n        if (fromEl[name]) {\n            fromEl.setAttribute(name, '');\n        } else {\n            fromEl.removeAttribute(name, '');\n        }\n    }\n}\n\nvar specialElHandlers = {\n    /**\n     * Needed for IE. Apparently IE doesn't think that \"selected\" is an\n     * attribute when reading over the attributes using selectEl.attributes\n     */\n    OPTION: function(fromEl, toEl) {\n        syncBooleanAttrProp(fromEl, toEl, 'selected');\n    },\n    /**\n     * The \"value\" attribute is special for the <input> element since it sets\n     * the initial value. Changing the \"value\" attribute without changing the\n     * \"value\" property will have no effect since it is only used to the set the\n     * initial value.  Similar for the \"checked\" attribute, and \"disabled\".\n     */\n    INPUT: function(fromEl, toEl) {\n        syncBooleanAttrProp(fromEl, toEl, 'checked');\n        syncBooleanAttrProp(fromEl, toEl, 'disabled');\n\n        if (fromEl.value !== toEl.value) {\n            fromEl.value = toEl.value;\n        }\n\n        if (!hasAttributeNS(toEl, null, 'value')) {\n            fromEl.removeAttribute('value');\n        }\n    },\n\n    TEXTAREA: function(fromEl, toEl) {\n        var newValue = toEl.value;\n        if (fromEl.value !== newValue) {\n            fromEl.value = newValue;\n        }\n\n        if (fromEl.firstChild) {\n            fromEl.firstChild.nodeValue = newValue;\n        }\n    }\n};\n\nfunction noop() {}\n\n/**\n * Returns true if two node's names are the same.\n *\n * NOTE: We don't bother checking `namespaceURI` because you will never find two HTML elements with the same\n *       nodeName and different namespace URIs.\n *\n * @param {Element} a\n * @param {Element} b The target element\n * @return {boolean}\n */\nfunction compareNodeNames(fromEl, toEl) {\n    var fromNodeName = fromEl.nodeName;\n    var toNodeName = toEl.nodeName;\n\n    if (fromNodeName === toNodeName) {\n        return true;\n    }\n\n    if (toEl.actualize &&\n        fromNodeName.charCodeAt(0) < 91 && /* from tag name is upper case */\n        toNodeName.charCodeAt(0) > 90 /* target tag name is lower case */) {\n        // If the target element is a virtual DOM node then we may need to normalize the tag name\n        // before comparing. Normal HTML elements that are in the \"http://www.w3.org/1999/xhtml\"\n        // are converted to upper case\n        return fromNodeName === toNodeName.toUpperCase();\n    } else {\n        return false;\n    }\n}\n\n/**\n * Create an element, optionally with a known namespace URI.\n *\n * @param {string} name the element name, e.g. 'div' or 'svg'\n * @param {string} [namespaceURI] the element's namespace URI, i.e. the value of\n * its `xmlns` attribute or its inferred namespace.\n *\n * @return {Element}\n */\nfunction createElementNS(name, namespaceURI) {\n    return !namespaceURI || namespaceURI === NS_XHTML ?\n        doc.createElement(name) :\n        doc.createElementNS(namespaceURI, name);\n}\n\n/**\n * Loop over all of the attributes on the target node and make sure the original\n * DOM node has the same attributes. If an attribute found on the original node\n * is not on the new node then remove it from the original node.\n *\n * @param  {Element} fromNode\n * @param  {Element} toNode\n */\nfunction morphAttrs(fromNode, toNode) {\n    var attrs = toNode.attributes;\n    var i;\n    var attr;\n    var attrName;\n    var attrNamespaceURI;\n    var attrValue;\n    var fromValue;\n\n    if (toNode.assignAttributes) {\n        toNode.assignAttributes(fromNode);\n    } else {\n        for (i = attrs.length - 1; i >= 0; --i) {\n            attr = attrs[i];\n            attrName = attr.name;\n            attrNamespaceURI = attr.namespaceURI;\n            attrValue = attr.value;\n\n            if (attrNamespaceURI) {\n                attrName = attr.localName || attrName;\n                fromValue = fromNode.getAttributeNS(attrNamespaceURI, attrName);\n\n                if (fromValue !== attrValue) {\n                    fromNode.setAttributeNS(attrNamespaceURI, attrName, attrValue);\n                }\n            } else {\n                fromValue = fromNode.getAttribute(attrName);\n\n                if (fromValue !== attrValue) {\n                    fromNode.setAttribute(attrName, attrValue);\n                }\n            }\n        }\n    }\n\n    // Remove any extra attributes found on the original DOM element that\n    // weren't found on the target element.\n    attrs = fromNode.attributes;\n\n    for (i = attrs.length - 1; i >= 0; --i) {\n        attr = attrs[i];\n        if (attr.specified !== false) {\n            attrName = attr.name;\n            attrNamespaceURI = attr.namespaceURI;\n\n            if (attrNamespaceURI) {\n                attrName = attr.localName || attrName;\n\n                if (!hasAttributeNS(toNode, attrNamespaceURI, attrName)) {\n                    fromNode.removeAttributeNS(attrNamespaceURI, attrName);\n                }\n            } else {\n                if (!hasAttributeNS(toNode, null, attrName)) {\n                    fromNode.removeAttribute(attrName);\n                }\n            }\n        }\n    }\n}\n\n/**\n * Copies the children of one DOM element to another DOM element\n */\nfunction moveChildren(fromEl, toEl) {\n    var curChild = fromEl.firstChild;\n    while (curChild) {\n        var nextChild = curChild.nextSibling;\n        toEl.appendChild(curChild);\n        curChild = nextChild;\n    }\n    return toEl;\n}\n\nfunction defaultGetNodeKey(node) {\n    return node.id;\n}\n\nfunction morphdom(fromNode, toNode, options) {\n    if (!options) {\n        options = {};\n    }\n\n    if (typeof toNode === 'string') {\n        if (fromNode.nodeName === '#document' || fromNode.nodeName === 'HTML') {\n            var toNodeHtml = toNode;\n            toNode = doc.createElement('html');\n            toNode.innerHTML = toNodeHtml;\n        } else {\n            toNode = toElement(toNode);\n        }\n    }\n\n    var getNodeKey = options.getNodeKey || defaultGetNodeKey;\n    var onBeforeNodeAdded = options.onBeforeNodeAdded || noop;\n    var onNodeAdded = options.onNodeAdded || noop;\n    var onBeforeElUpdated = options.onBeforeElUpdated || noop;\n    var onElUpdated = options.onElUpdated || noop;\n    var onBeforeNodeDiscarded = options.onBeforeNodeDiscarded || noop;\n    var onNodeDiscarded = options.onNodeDiscarded || noop;\n    var onBeforeElChildrenUpdated = options.onBeforeElChildrenUpdated || noop;\n    var childrenOnly = options.childrenOnly === true;\n\n    // This object is used as a lookup to quickly find all keyed elements in the original DOM tree.\n    var fromNodesLookup = {};\n    var keyedRemovalList;\n\n    function addKeyedRemoval(key) {\n        if (keyedRemovalList) {\n            keyedRemovalList.push(key);\n        } else {\n            keyedRemovalList = [key];\n        }\n    }\n\n    function walkDiscardedChildNodes(node, skipKeyedNodes) {\n        if (node.nodeType === ELEMENT_NODE) {\n            var curChild = node.firstChild;\n            while (curChild) {\n\n                var key = undefined;\n\n                if (skipKeyedNodes && (key = getNodeKey(curChild))) {\n                    // If we are skipping keyed nodes then we add the key\n                    // to a list so that it can be handled at the very end.\n                    addKeyedRemoval(key);\n                } else {\n                    // Only report the node as discarded if it is not keyed. We do this because\n                    // at the end we loop through all keyed elements that were unmatched\n                    // and then discard them in one final pass.\n                    onNodeDiscarded(curChild);\n                    if (curChild.firstChild) {\n                        walkDiscardedChildNodes(curChild, skipKeyedNodes);\n                    }\n                }\n\n                curChild = curChild.nextSibling;\n            }\n        }\n    }\n\n    /**\n     * Removes a DOM node out of the original DOM\n     *\n     * @param  {Node} node The node to remove\n     * @param  {Node} parentNode The nodes parent\n     * @param  {Boolean} skipKeyedNodes If true then elements with keys will be skipped and not discarded.\n     * @return {undefined}\n     */\n    function removeNode(node, parentNode, skipKeyedNodes) {\n        if (onBeforeNodeDiscarded(node) === false) {\n            return;\n        }\n\n        if (parentNode) {\n            parentNode.removeChild(node);\n        }\n\n        onNodeDiscarded(node);\n        walkDiscardedChildNodes(node, skipKeyedNodes);\n    }\n\n    // // TreeWalker implementation is no faster, but keeping this around in case this changes in the future\n    // function indexTree(root) {\n    //     var treeWalker = document.createTreeWalker(\n    //         root,\n    //         NodeFilter.SHOW_ELEMENT);\n    //\n    //     var el;\n    //     while((el = treeWalker.nextNode())) {\n    //         var key = getNodeKey(el);\n    //         if (key) {\n    //             fromNodesLookup[key] = el;\n    //         }\n    //     }\n    // }\n\n    // // NodeIterator implementation is no faster, but keeping this around in case this changes in the future\n    //\n    // function indexTree(node) {\n    //     var nodeIterator = document.createNodeIterator(node, NodeFilter.SHOW_ELEMENT);\n    //     var el;\n    //     while((el = nodeIterator.nextNode())) {\n    //         var key = getNodeKey(el);\n    //         if (key) {\n    //             fromNodesLookup[key] = el;\n    //         }\n    //     }\n    // }\n\n    function indexTree(node) {\n        if (node.nodeType === ELEMENT_NODE) {\n            var curChild = node.firstChild;\n            while (curChild) {\n                var key = getNodeKey(curChild);\n                if (key) {\n                    fromNodesLookup[key] = curChild;\n                }\n\n                // Walk recursively\n                indexTree(curChild);\n\n                curChild = curChild.nextSibling;\n            }\n        }\n    }\n\n    indexTree(fromNode);\n\n    function handleNodeAdded(el) {\n        onNodeAdded(el);\n\n        var curChild = el.firstChild;\n        while (curChild) {\n            var nextSibling = curChild.nextSibling;\n\n            var key = getNodeKey(curChild);\n            if (key) {\n                var unmatchedFromEl = fromNodesLookup[key];\n                if (unmatchedFromEl && compareNodeNames(curChild, unmatchedFromEl)) {\n                    curChild.parentNode.replaceChild(unmatchedFromEl, curChild);\n                    morphEl(unmatchedFromEl, curChild);\n                }\n            }\n\n            handleNodeAdded(curChild);\n            curChild = nextSibling;\n        }\n    }\n\n    function morphEl(fromEl, toEl, childrenOnly) {\n        var toElKey = getNodeKey(toEl);\n        var curFromNodeKey;\n\n        if (toElKey) {\n            // If an element with an ID is being morphed then it is will be in the final\n            // DOM so clear it out of the saved elements collection\n            delete fromNodesLookup[toElKey];\n        }\n\n        if (toNode.isSameNode && toNode.isSameNode(fromNode)) {\n            return;\n        }\n\n        if (!childrenOnly) {\n            if (onBeforeElUpdated(fromEl, toEl) === false) {\n                return;\n            }\n\n            morphAttrs(fromEl, toEl);\n            onElUpdated(fromEl);\n\n            if (onBeforeElChildrenUpdated(fromEl, toEl) === false) {\n                return;\n            }\n        }\n\n        if (fromEl.nodeName !== 'TEXTAREA') {\n            var curToNodeChild = toEl.firstChild;\n            var curFromNodeChild = fromEl.firstChild;\n            var curToNodeKey;\n\n            var fromNextSibling;\n            var toNextSibling;\n            var matchingFromEl;\n\n            outer: while (curToNodeChild) {\n                toNextSibling = curToNodeChild.nextSibling;\n                curToNodeKey = getNodeKey(curToNodeChild);\n\n                while (curFromNodeChild) {\n                    fromNextSibling = curFromNodeChild.nextSibling;\n\n                    if (curToNodeChild.isSameNode && curToNodeChild.isSameNode(curFromNodeChild)) {\n                        curToNodeChild = toNextSibling;\n                        curFromNodeChild = fromNextSibling;\n                        continue outer;\n                    }\n\n                    curFromNodeKey = getNodeKey(curFromNodeChild);\n\n                    var curFromNodeType = curFromNodeChild.nodeType;\n\n                    var isCompatible = undefined;\n\n                    if (curFromNodeType === curToNodeChild.nodeType) {\n                        if (curFromNodeType === ELEMENT_NODE) {\n                            // Both nodes being compared are Element nodes\n\n                            if (curToNodeKey) {\n                                // The target node has a key so we want to match it up with the correct element\n                                // in the original DOM tree\n                                if (curToNodeKey !== curFromNodeKey) {\n                                    // The current element in the original DOM tree does not have a matching key so\n                                    // let's check our lookup to see if there is a matching element in the original\n                                    // DOM tree\n                                    if ((matchingFromEl = fromNodesLookup[curToNodeKey])) {\n                                        if (curFromNodeChild.nextSibling === matchingFromEl) {\n                                            // Special case for single element removals. To avoid removing the original\n                                            // DOM node out of the tree (since that can break CSS transitions, etc.),\n                                            // we will instead discard the current node and wait until the next\n                                            // iteration to properly match up the keyed target element with its matching\n                                            // element in the original tree\n                                            isCompatible = false;\n                                        } else {\n                                            // We found a matching keyed element somewhere in the original DOM tree.\n                                            // Let's moving the original DOM node into the current position and morph\n                                            // it.\n\n                                            // NOTE: We use insertBefore instead of replaceChild because we want to go through\n                                            // the `removeNode()` function for the node that is being discarded so that\n                                            // all lifecycle hooks are correctly invoked\n                                            fromEl.insertBefore(matchingFromEl, curFromNodeChild);\n\n                                            if (curFromNodeKey) {\n                                                // Since the node is keyed it might be matched up later so we defer\n                                                // the actual removal to later\n                                                addKeyedRemoval(curFromNodeKey);\n                                            } else {\n                                                // NOTE: we skip nested keyed nodes from being removed since there is\n                                                //       still a chance they will be matched up later\n                                                removeNode(curFromNodeChild, fromEl, true /* skip keyed nodes */);\n\n                                            }\n                                            fromNextSibling = curFromNodeChild.nextSibling;\n                                            curFromNodeChild = matchingFromEl;\n                                        }\n                                    } else {\n                                        // The nodes are not compatible since the \"to\" node has a key and there\n                                        // is no matching keyed node in the source tree\n                                        isCompatible = false;\n                                    }\n                                }\n                            } else if (curFromNodeKey) {\n                                // The original has a key\n                                isCompatible = false;\n                            }\n\n                            isCompatible = isCompatible !== false && compareNodeNames(curFromNodeChild, curToNodeChild);\n                            if (isCompatible) {\n                                // We found compatible DOM elements so transform\n                                // the current \"from\" node to match the current\n                                // target DOM node.\n                                morphEl(curFromNodeChild, curToNodeChild);\n                            }\n\n                        } else if (curFromNodeType === TEXT_NODE || curFromNodeType == COMMENT_NODE) {\n                            // Both nodes being compared are Text or Comment nodes\n                            isCompatible = true;\n                            // Simply update nodeValue on the original node to\n                            // change the text value\n                            curFromNodeChild.nodeValue = curToNodeChild.nodeValue;\n                        }\n                    }\n\n                    if (isCompatible) {\n                        // Advance both the \"to\" child and the \"from\" child since we found a match\n                        curToNodeChild = toNextSibling;\n                        curFromNodeChild = fromNextSibling;\n                        continue outer;\n                    }\n\n                    // No compatible match so remove the old node from the DOM and continue trying to find a\n                    // match in the original DOM. However, we only do this if the from node is not keyed\n                    // since it is possible that a keyed node might match up with a node somewhere else in the\n                    // target tree and we don't want to discard it just yet since it still might find a\n                    // home in the final DOM tree. After everything is done we will remove any keyed nodes\n                    // that didn't find a home\n                    if (curFromNodeKey) {\n                        // Since the node is keyed it might be matched up later so we defer\n                        // the actual removal to later\n                        addKeyedRemoval(curFromNodeKey);\n                    } else {\n                        // NOTE: we skip nested keyed nodes from being removed since there is\n                        //       still a chance they will be matched up later\n                        removeNode(curFromNodeChild, fromEl, true /* skip keyed nodes */);\n                    }\n\n                    curFromNodeChild = fromNextSibling;\n                }\n\n                // If we got this far then we did not find a candidate match for\n                // our \"to node\" and we exhausted all of the children \"from\"\n                // nodes. Therefore, we will just append the current \"to\" node\n                // to the end\n                if (curToNodeKey && (matchingFromEl = fromNodesLookup[curToNodeKey]) && compareNodeNames(matchingFromEl, curToNodeChild)) {\n                    fromEl.appendChild(matchingFromEl);\n                    morphEl(matchingFromEl, curToNodeChild);\n                } else {\n                    var onBeforeNodeAddedResult = onBeforeNodeAdded(curToNodeChild);\n                    if (onBeforeNodeAddedResult !== false) {\n                        if (onBeforeNodeAddedResult) {\n                            curToNodeChild = onBeforeNodeAddedResult;\n                        }\n\n                        if (curToNodeChild.actualize) {\n                            curToNodeChild = curToNodeChild.actualize(fromEl.ownerDocument || doc);\n                        }\n                        fromEl.appendChild(curToNodeChild);\n                        handleNodeAdded(curToNodeChild);\n                    }\n                }\n\n                curToNodeChild = toNextSibling;\n                curFromNodeChild = fromNextSibling;\n            }\n\n            // We have processed all of the \"to nodes\". If curFromNodeChild is\n            // non-null then we still have some from nodes left over that need\n            // to be removed\n            while (curFromNodeChild) {\n                fromNextSibling = curFromNodeChild.nextSibling;\n                if ((curFromNodeKey = getNodeKey(curFromNodeChild))) {\n                    // Since the node is keyed it might be matched up later so we defer\n                    // the actual removal to later\n                    addKeyedRemoval(curFromNodeKey);\n                } else {\n                    // NOTE: we skip nested keyed nodes from being removed since there is\n                    //       still a chance they will be matched up later\n                    removeNode(curFromNodeChild, fromEl, true /* skip keyed nodes */);\n                }\n                curFromNodeChild = fromNextSibling;\n            }\n        }\n\n        var specialElHandler = specialElHandlers[fromEl.nodeName];\n        if (specialElHandler) {\n            specialElHandler(fromEl, toEl);\n        }\n    } // END: morphEl(...)\n\n    var morphedNode = fromNode;\n    var morphedNodeType = morphedNode.nodeType;\n    var toNodeType = toNode.nodeType;\n\n    if (!childrenOnly) {\n        // Handle the case where we are given two DOM nodes that are not\n        // compatible (e.g. <div> --> <span> or <div> --> TEXT)\n        if (morphedNodeType === ELEMENT_NODE) {\n            if (toNodeType === ELEMENT_NODE) {\n                if (!compareNodeNames(fromNode, toNode)) {\n                    onNodeDiscarded(fromNode);\n                    morphedNode = moveChildren(fromNode, createElementNS(toNode.nodeName, toNode.namespaceURI));\n                }\n            } else {\n                // Going from an element node to a text node\n                morphedNode = toNode;\n            }\n        } else if (morphedNodeType === TEXT_NODE || morphedNodeType === COMMENT_NODE) { // Text or comment node\n            if (toNodeType === morphedNodeType) {\n                morphedNode.nodeValue = toNode.nodeValue;\n                return morphedNode;\n            } else {\n                // Text node to something else\n                morphedNode = toNode;\n            }\n        }\n    }\n\n    if (morphedNode === toNode) {\n        // The \"to node\" was not compatible with the \"from node\" so we had to\n        // toss out the \"from node\" and use the \"to node\"\n        onNodeDiscarded(fromNode);\n    } else {\n        morphEl(morphedNode, toNode, childrenOnly);\n\n        // We now need to loop over any keyed nodes that might need to be\n        // removed. We only do the removal if we know that the keyed node\n        // never found a match. When a keyed node is matched up we remove\n        // it out of fromNodesLookup and we use fromNodesLookup to determine\n        // if a keyed node has been matched up or not\n        if (keyedRemovalList) {\n            for (var i=0, len=keyedRemovalList.length; i<len; i++) {\n                var elToRemove = fromNodesLookup[keyedRemovalList[i]];\n                if (elToRemove) {\n                    removeNode(elToRemove, elToRemove.parentNode, false);\n                }\n            }\n        }\n    }\n\n    if (!childrenOnly && morphedNode !== fromNode && fromNode.parentNode) {\n        if (morphedNode.actualize) {\n            morphedNode = morphedNode.actualize(fromNode.ownerDocument || doc);\n        }\n        // If we had to swap out the from node with a new node because the old\n        // node was not compatible with the target node then we need to\n        // replace the old DOM node in the original DOM tree. This is only\n        // possible if the original DOM node was part of a DOM tree which\n        // we know is the case if it has a parent node.\n        fromNode.parentNode.replaceChild(morphedNode, fromNode);\n    }\n\n    return morphedNode;\n}\n\nmodule.exports = morphdom;\n","'use strict';\n\nimport Utils from '../utils.js';\nimport Messaging from './messaging.js';\nimport PatchDOM from 'morphdom';\n\n\n\n\n\n// The module pattern\nvar GhostWorkerDOM = (function () {\n\n    let m = {};\n    m.version = 0.1;\n    m.cacheName = 'ghostworker';\n    m.contentEvent = new Event('GhostWorkerLoaded');\n    m.contentDOMLoadedEvent = new Event('GhostWorkerDOMContentLoaded');\n\n\n    m.create = function(){\n\n        var self = this;\n        var url = document.location.href;\n        //this.createJSON(document, url);\n\n        Messaging.getSiteData()\n            .then(function(siteData){\n\n                if(siteData){\n                    self.createJSON(document, url, siteData);\n                    self.match(Utils.urlReplacePath(url, siteData.templatePath), '-template')\n                        .then(function (response) {\n                            // create base template first\n                            if(response.error){\n                                self.createTemplate(document, url, siteData, siteData);\n                            }\n                            // then build route template\n                            self.createTemplate(document, url, null, siteData);\n                        });\n                }else{\n                    this.createTemplate(document, url, null, siteData);\n                }\n                // fire off as we have all the HTML loaded before we create templates\n                document.dispatchEvent(self.contentDOMLoadedEvent);\n            });\n\n    };\n\n\n    m.hasTemplate = function( url ){\n\n        var self = this;\n\n        return Messaging.getRouteData(url)\n            .then(function (routeData) {\n                var request = self.newRequest(Utils.urlReplacePath(url, routeData.templatePath), {});\n                return window.caches.match(request);\n            })\n            .then(function (response) {\n                return (response) ? true : false;\n            })\n    }\n\n\n    // creates JSON from full DOM\n    m.createJSON = function(doc, url, siteData){\n\n        // create json object\n        var self = this;\n        var out = {};\n        out.replacements = [];\n        //var routeData = Messaging.getRouteData( url );\n\n        return Messaging.getRouteData( url )\n            .then(function(routeData){\n\n\n                routeData.elements.forEach( function(selector){\n                    var nodeList = doc.querySelectorAll(selector);\n                    var item = {\n                            selector: selector,\n                            content: []\n                        };\n                    if(nodeList){\n                        for (var i = 0; i < nodeList.length; ++i) {\n                            item.content.push(nodeList[i].outerHTML);\n                        }\n                    }\n                out.replacements.push(item);\n                })\n\n                out.metaTags = self.loopMetaTags(siteData, routeData, doc, false);\n                out.linkTags = self.loopLinkTags(siteData, routeData, doc, false);\n\n                var headers = new Headers();\n                headers.append('X-Ghost-Worker-Cache-Date',  new Date().toISOString());\n                self.jsonRequest = self.newRequest(Utils.urlJoinPath(url, '-json'), {'headers': headers});\n                self.jsonResponse = self.newResponse(JSON.stringify(out), 'application/json');\n                self.put( self.cacheName + '-content-v' + self.version, self.jsonRequest, self.jsonResponse );\n\n                return out;\n            })\n            .catch(function(reason) {\n                console.log('createJSON' + reason);\n            });\n\n\n        //return out;\n    };\n\n\n    // creates template from full DOM\n    m.createTemplate = function(doc, url, routeData, siteData){\n\n        // create html template\n        var self = this;\n        var out = {}\n        out.replacements = [];\n\n        // check if routeData is object if so resolve directly if not go get it\n        return (routeData? Promise.resolve(routeData) : Messaging.getRouteData( url ))\n            .then(function( routeData ){\n\n                var newDoc = document.documentElement.cloneNode(true);\n                self.removeGhostworkerScript(newDoc);\n                self.clearElements(newDoc, routeData.elements);\n                // remove meta and link values from page that need updating with data\n                self.loopMetaTags(siteData, routeData, newDoc, true);\n                self.loopLinkTags(siteData, routeData, newDoc, true);\n\n                var headers = new Headers();\n                headers.append('X-Ghost-Worker-Cache-Date',  new Date().toISOString());\n                self.templateRequest = self.newRequest( Utils.urlReplacePath(url, routeData.templatePath), {'headers': headers});\n                self.templateResponse = self.newResponse(newDoc.outerHTML, 'text/html');\n                self.put( self.cacheName + '-template-v' + self.version, self.templateRequest, self.templateResponse );\n                return newDoc.outerHTML;\n            })\n            .catch(function(reason) {\n                console.log('createTemplate' + reason);\n            });\n\n\n        /*\n        routeData = routeData || Messaging.getRouteData( url );\n        var newDoc = document.documentElement.cloneNode(true);\n        this.removeGhostworkerScript(newDoc);\n        this.clearElements(newDoc, routeData.elements);\n        // remove meta and link values from page that need updating with data\n        this.loopMetaTags(siteData, routeData, newDoc, true);\n        this.loopLinkTags(siteData, routeData, newDoc, true);\n\n        var headers = new Headers();\n        headers.append('X-Ghost-Worker-Cache-Date',  new Date().toISOString());\n        this.templateRequest = this.newRequest( Utils.urlReplacePath(url, routeData.templatePath), {'headers': headers});\n        this.templateResponse = this.newResponse(newDoc.outerHTML, 'text/html');\n        this.put( this.cacheName + '-template-v' + this.version, this.templateRequest, this.templateResponse );\n        return newDoc.outerHTML;\n        */\n    };\n\n\n    m.clearElements = function(document, elements){\n        if(elements){\n            elements.forEach( function(selector){\n                var nodeList = document.querySelectorAll(selector);\n                if(nodeList){\n                    for (var i = 0; i < nodeList.length; ++i) {\n                        // leave as innerHTML so we can target element with selector later\n                        nodeList[i].innerHTML = '';\n                    }\n                }\n            });\n        }\n    }\n\n\n    // <meta> tag data collection and value blanking\n    m.loopMetaTags = function (siteData, routeData, doc, removeValues) {\n        let out = null;\n        let metaNames = siteData.metaTags || [];\n        if (routeData && routeData.metaTags) {\n            metaNames.concat(routeData.metaTags);\n        }\n        var nodeList = doc.querySelectorAll('meta');\n        if (nodeList) {\n            for (var i = 0; i < nodeList.length; ++i) {\n                if (nodeList[i].name && nodeList[i].content) {\n                    var name = nodeList[i].name;\n                    if (metaNames.indexOf(name) > -1) {\n\n                        out = out || {};\n                        out[name] = nodeList[i].content;\n\n                        if(removeValues === true){\n                            nodeList[i].content = '';\n                        }\n                    }\n                }\n            }\n        }\n        return out;\n    }\n\n\n    // <link> tag data collection and value blanking\n    m.loopLinkTags = function (siteData, routeData, doc, removeValues) {\n        var out = null;\n        var links = siteData.linkTags || [];\n        if (routeData && routeData.linkTag) {\n            links.concat(routeData.linkTag);\n        }\n        // link[{attr:value}]\n        links.forEach(function (link) {\n            var selector = 'link';\n            for (var attrKey in link) {\n                if (attrKey.hasOwnProperty(link)) {\n                    selector += '[' + attrKey + '=\"' + link[attrKey] + '\"]';\n                }\n            }\n            var node = doc.querySelector(selector);\n            if (node && node.href) {\n\n                var letNewlink = Utils.clone(link);\n                letNewlink.href = node.href;\n                out = out || [];\n                out.push(letNewlink);\n\n                if (removeValues === true) {\n                    node.href = '';\n                }\n            }\n        });\n\n        return out;\n    }\n\n\n    m.removeGhostworkerScript = function( doc ){\n        var nodeList = doc.querySelectorAll('.ghostworker-script');\n        if(nodeList){\n            for (var i = 0; i < nodeList.length; ++i) {\n                nodeList[i].parentNode.removeChild(nodeList[i]);\n            }\n        }\n    }\n\n\n    m.newRequest = function(url, options){\n        return new Request(url, options);\n    };\n\n\n    m.newResponse = function(bodyString, type){\n        var options = {\n            status: 200,\n            statusText: \"OK\",\n            headers: {'Content-Type': type} // text/html or application/json\n        };\n        return new Response(bodyString, options);\n    };\n\n\n    m.put = function( cacheName, request, response ){\n        caches.open(cacheName).then(function (cache) {\n            if(request && response ){\n                cache.put(request, response)\n            }\n        });\n    };\n\n\n    m.match = function (url, options) {\n        var request = this.newRequest(url, options);\n        return caches.match(request)\n            .then(function (response) {\n                return response;\n            });\n    }\n\n\n    // call to add JSON to page\n    m.addJSON = function ( url, redrawLevel ) {\n\n        var self = this;\n        url = url || document.location.href;\n\n        var routeData = Messaging.getRouteData( url );\n\n\n        Promise.all([\n            Messaging.getSiteData(),\n            Messaging.getRouteData( url )\n        ])\n            .then(function(results){\n                var siteData = results[0];\n                var routeData = results[1];\n\n\n                // add header so the template logic is not fired in service worker\n                var headers = new Headers();\n                headers.append('X-Ghost-Worker-Content', 'raw');\n                headers.append('X-Ghost-Worker-RouteData', JSON.stringify(routeData));\n\n                var request = new Request(url, { headers: headers });\n\n\n\n                // find JSON in cache\n                // *********************************************************************************************************** //\n                self.match( new Request(Utils.urlJoinPath(url, '-json')), '-json' )\n                    .then(function(json){\n\n                        // has a site template info\n\n                        // does current template match new template\n                        if(siteData && redrawLevel === 'site'){\n                            // default to site template\n                            self.clearElements(document, siteData.elements);\n                            // remove meta and link values from page that need updating with data\n                            self.loopMetaTags(siteData, routeData, document, true);\n                            self.loopLinkTags(siteData, routeData, document, true);\n\n                            // load template from cache\n                            var templateRequest = self.newRequest( Utils.urlReplacePath(url, routeData.templatePath), {});\n                            // *********************************************************************************************************** //\n                            self.match( templateRequest, '-template' )\n                                .then(function( templateJSON ){\n                                    if(!templateJSON){\n                                        console.log('addJSON no template found')\n                                    }else{\n                                        self.injectTemplateJSON( templateJSON )\n                                            .then(function(done){\n                                                if(!json.error){\n                                                    self.injectJSON(json, true);\n                                                }\n                                            });\n                                    }\n                                });\n\n\n                        }else{\n                            if(!json.error){\n                                self.injectJSON(json, true);\n                            }\n                        }\n\n                        // get it from network inject either to add or update content\n                        // *********************************************************************************************************** //\n                        self.createJSONFromNetwork(request, siteData)\n                            .then(function (json) {\n                                if (json && !json.error) {\n                                    self.injectJSON(json, false);\n                                } else {\n                                    console.log('createJSONFromNetwork');\n                                }\n                            })\n                            .catch(function(reason) {\n                                console.log('createJSONFromNetwork' + reason);\n                            });\n                        });\n\n\n            })\n            .catch(function(reason){\n                console.log(reason)\n            })\n\n\n    };\n\n\n    // get JSON form network - downloads HTML and creates JSON structure\n    m.createJSONFromNetwork = function( request, siteData ){\n\n        var self = this;\n        return fetch(request)\n            .then(function(response) {\n\n                if (request.method === 'GET' &&\n                    response.status > 199 &&\n                    response.status < 400) {\n\n                    return response.text()\n                        .then(function (body) {\n                            let parser = new DOMParser();\n                            return parser.parseFromString(body, \"text/html\");\n                        })\n                        .then(function (doc) {\n                            return self.createJSON(doc, request.url, siteData);\n                        });\n                }else{\n                    return {error: 'response issue'}\n                }\n            })\n            .catch(function(reason){\n                console.log('createJSONFromNetwork', reason)\n            })\n    }\n\n\n    // get  -json or -template responses from cache\n    m.match = function( request, suffix ){\n\n        /*\n        url = url || document.location.href;\n        suffix = suffix || - '-json';\n        var request;\n        if(suffix === '-json'){\n            request = this.newRequest(Utils.urlJoinPath(url, suffix), {});\n        }else{\n            request = this.newRequest(Utils.urlReplacePath(url, suffix), {});\n        }\n        */\n\n        return window.caches.match(request)\n            .then(function(response) {\n\n                if(response){\n                    var clonedResponse = response.clone();\n                    if(clonedResponse && clonedResponse.status >= 200 && clonedResponse.status < 400){\n                        return response.text().then(function(body){\n                            return (suffix === '-json')? JSON.parse(body) : {'template': body};\n                        });\n                    }\n                    return {error: 'response issue'}\n                }else{\n                    return {error: 'no match'}\n                }\n            }\n        )\n    }\n\n\n    m.injectTemplateJSON = function( json ){\n\n        let parser = new DOMParser();\n        let doc = parser.parseFromString(json.template, \"text/html\");\n\n        // copy elements between documents to recreate a route template\n        return Messaging.getSiteData()\n            .then(function(siteDate){\n                if(siteDate && siteDate.elements){\n                    siteDate.elements.forEach( function(selector){\n                        var destination = document.querySelector(selector);\n                        var source = doc.querySelector(selector);\n                        destination.parentNode.replaceChild(source, destination);\n                    });\n                }\n                return true;\n            });\n\n\n\n    }\n\n\n    m.injectJSON = function( json, firstDraw ){\n        var self = this;\n\n        // elements\n        json.replacements.forEach( function(replacement, idx){\n            var nodeList = document.querySelectorAll(replacement.selector);\n            if(nodeList){\n                for (var i = 0; i < nodeList.length; ++i) {\n                    if(replacement.content[i]){\n                        //nodeList[i].outerHTML = replacement.content[i];\n\n                        // on update this should patch direct from one DOM node to another rather than using JSON html\n                        PatchDOM(nodeList[i], replacement.content[i]);\n\n                        // fire after last modification of DOM from injecting JSON\n                        if(idx === json.replacements.length-1 && i === nodeList.length-1 ){\n                            document.dispatchEvent(self.contentDOMLoadedEvent);\n                        }\n                    }\n                }\n            }\n        });\n\n        // meta\n        if(json.metaTags){\n            for(name in json.metaTags){\n                var selector = 'meta[name=\"' + name + '\"]';\n                var node = document.querySelector(selector);\n                if(node && node.content){\n                    node.content = json.metaTags[name];\n                }\n            }\n        }\n\n        // link\n        if(json.linkTags){\n            json.linkTags.forEach(function( link ) {\n                var selector = 'link';\n                for(var attr in link){\n                    if (link.hasOwnProperty(attr)) {\n                        if(attr !== 'href'){\n                            selector += '['+ attr + '=\"' + link[attr] + '\"]';\n                        }\n                    }\n                }\n                var node = document.querySelector(selector);\n                if(node && node.href && link.href){\n                    node.href = link.href;\n                }\n            })\n        }\n\n        this.captureLinks();\n    }\n\n\n\n    m.captureLinks = function(){\n        var nodeList = document.querySelectorAll('a');\n        if(nodeList){\n            for (var i = 0; i < nodeList.length; ++i) {\n\n                // browser should not allow binding twice\n                //nodeList[i].removeEventListener('click', this.clickEvent ,true);\n                nodeList[i].addEventListener('click', this.clickEvent ,true);\n            }\n        }\n    }\n\n    m.clickEvent = function (e) {\n        console.log('link fired');\n\n        let documentUrl = new URL(document.location.href);\n        let targetUrl = new URL(e.currentTarget.href);\n\n        e.preventDefault();\n\n        Promise.all([\n            Messaging.getRouteData( documentUrl.toString() ),\n            Messaging.getRouteData( targetUrl.toString() )\n        ])\n            .then(function(results){\n                console.log(JSON.stringify(results));\n\n                let documentRouteData = results[0];\n                let targetRouteData = results[1];\n\n                // both current and target URLs are part of routing system\n                if(documentRouteData && targetRouteData){\n\n                    // they are from the same section - match on section template name\n                    if (targetRouteData.templatePath === documentRouteData.templatePath) {\n\n                        console.log('uses same template - load just json');\n                        GhostWorkerDOM.addJSON(targetUrl.toString(), 'route');\n                        history.pushState({}, '', targetUrl.toString());\n\n                    } else {\n\n                        // route is in system but uses a different route template\n                        GhostWorkerDOM.hasTemplate( targetUrl.toString() )\n                            .then(function(hasTemplate){\n                                if(hasTemplate === true){\n                                    GhostWorkerDOM.addJSON(targetUrl.toString(), 'site');\n                                    history.pushState({}, '', targetUrl.toString());\n                                }else{\n                                    console.log('let HTTP request pass through');\n                                    document.location.href = targetUrl.toString();\n                                }\n                            })\n                    }\n                }else{\n                    document.location.href = targetUrl.toString();\n                }\n\n\n            })\n            .catch(function(reason){\n                console.log(reason)\n            });\n\n    }\n\n\n\n\n    return m;\n\n\n} ());\n\n\nexport default GhostWorkerDOM\n\n\n"],"names":["removeLastBackslash","path","endsWith","slice","urlJoinPath","url","URL","pathname","toString","urlReplacePath","urlRemoveBackslash","str","match","position","isFinite","Math","floor","length","lastIndex","lastIndexOf","clone","obj","JSON","parse","stringify","handleErrors","response","ok","Error","statusText","exports","getDataFromSW","requestOptions","Promise","resolve","reject","messageChannel","MessageChannel","port1","onmessage","event","data","error","serviceWorker","controller","postMessage","port2","getRouteData","then","result","catch","reason","log","getSiteData","GhostWorkerDOM","m","version","cacheName","contentEvent","Event","contentDOMLoadedEvent","create","self","document","location","href","siteData","createJSON","Utils","templatePath","createTemplate","dispatchEvent","hasTemplate","Messaging","routeData","request","newRequest","window","caches","doc","out","replacements","elements","forEach","selector","nodeList","querySelectorAll","item","i","content","push","outerHTML","metaTags","loopMetaTags","linkTags","loopLinkTags","headers","Headers","append","Date","toISOString","jsonRequest","jsonResponse","newResponse","put","newDoc","documentElement","cloneNode","removeGhostworkerScript","clearElements","templateRequest","templateResponse","innerHTML","removeValues","metaNames","concat","name","indexOf","links","linkTag","link","attrKey","hasOwnProperty","node","querySelector","letNewlink","parentNode","removeChild","options","Request","bodyString","type","Response","open","cache","addJSON","redrawLevel","all","results","json","templateJSON","injectTemplateJSON","done","injectJSON","createJSONFromNetwork","fetch","method","status","text","body","parser","DOMParser","parseFromString","suffix","clonedResponse","template","siteDate","destination","source","replaceChild","firstDraw","replacement","idx","attr","captureLinks","addEventListener","clickEvent","e","documentUrl","targetUrl","currentTarget","preventDefault","documentRouteData","targetRouteData","pushState"],"mappings":"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"}