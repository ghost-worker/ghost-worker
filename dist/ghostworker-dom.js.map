{"version":3,"file":null,"sources":["../lib/utils.js","../lib/dom/messaging.js","../lib/dom/head.js","../node_modules/morphdom/src/index.js","../lib/dom/index.js"],"sourcesContent":["'use strict';\n\nfunction removeLastBackslash( path ){\n    return (endsWith(path , '/'))? path.slice(0, -1) : path;\n}\n\n\nfunction urlJoinPath( url, path ){\n    url = new URL( url );\n    url.pathname = url.pathname + path\n    return url.toString();\n}\n\n\nfunction urlReplacePath( url, path ){\n    url = new URL( url );\n    url.pathname = path\n    return url.toString();\n}\n\n\nfunction urlRemoveBackslash( url ){\n    url = new URL( url );\n    if(endsWith(url.pathname, '/')){\n      url.pathname = url.pathname.slice(0, -1);\n    }\n    return url.toString();\n}\n\n\nfunction endsWith(str, match, position) {\n  if (typeof position !== 'number' || !isFinite(position) || Math.floor(position) !== position || position > str.length) {\n    position = str.length;\n  }\n  position -= match.length;\n  var lastIndex = str.lastIndexOf(match, position);\n  return lastIndex !== -1 && lastIndex === position;\n}\n\n\nfunction clone(obj){\n    // very simple clone, be careful\n    return JSON.parse(JSON.stringify(obj))\n}\n\n\nif (typeof Object.assign != 'function') {\n  (function () {\n    Object.assign = function (target) {\n      'use strict';\n      // We must check against these specific cases.\n      if (target === undefined || target === null) {\n        throw new TypeError('Cannot convert undefined or null to object');\n      }\n\n      var output = Object(target);\n      for (var index = 1; index < arguments.length; index++) {\n        var source = arguments[index];\n        if (source !== undefined && source !== null) {\n          for (var nextKey in source) {\n            if (source.hasOwnProperty(nextKey)) {\n              output[nextKey] = source[nextKey];\n            }\n          }\n        }\n      }\n      return output;\n    };\n  })();\n}\n\n\n// handles fetch errs\nfunction handleErrors(response) {\n    if (!response.ok) {\n        throw Error(response.statusText);\n    }\n    return response;\n}\n\n\nmodule.exports = {\n    removeLastBackslash,\n    urlJoinPath,\n    urlReplacePath,\n    urlRemoveBackslash,\n    endsWith,\n    clone,\n    handleErrors\n};\n","'use strict';\n\nfunction getDataFromSW(requestOptions) {\n\n    return new Promise(function (resolve, reject) {\n        let messageChannel = new MessageChannel();\n        messageChannel.port1.onmessage = function (event) {\n            if (event.data.error) {\n                reject(event.data.error);\n            } else {\n                resolve(event.data);\n            }\n        };\n        navigator.serviceWorker.controller.postMessage(requestOptions, [messageChannel.port2]);\n    });\n}\n\n\nfunction getRouteData(url) {\n\n    return getDataFromSW({ 'command': 'getRouteData', 'url': url })\n        .then(function (response) {\n            return response.result;\n        }).catch(function (reason) {\n            console.log(reason);\n        });\n}\n\n\nfunction getSiteData() {\n\n    return getDataFromSW({ 'command': 'getSiteData' })\n        .then(function (response) {\n            return response.result;\n        }).catch(function (reason) {\n            console.log(reason);\n        });\n}\n\n\nfunction getVersion() {\n\n    return getDataFromSW({ 'command': 'getVersion' })\n        .then(function (response) {\n            return response.result;\n        }).catch(function (reason) {\n            console.log(reason);\n        });\n}\n\n\nmodule.exports = {\n    getRouteData,\n    getSiteData,\n    getVersion\n};\n","'use strict';\n\nlet siteWideLinkTags = ['stylesheet','manifest'];\nlet siteWideMetaTags = ['viewport','handheldfriendly','mobileoptimized','apple-mobile-web-app-capable','apple-mobile-web-app-status-bar-style'];\n\n\nfunction remove( headNode ){\n\n    return {\n        link: removeElements( headNode, 'link', 'rel',  siteWideLinkTags ),\n        meta: removeElements( headNode, 'meta', 'name', siteWideMetaTags ),\n    };\n}\n\nfunction removeElements( headNode, selector, checkAttr, keepList ){\n\n    let out = [];\n    let nodeList = headNode.querySelectorAll(selector);\n    for (var node of nodeList) {\n        if(isOnKeepList( node, checkAttr, keepList ) === false){\n            out.push( elementAttributes( node ) );\n            headNode.removeChild(node);\n        }\n    }\n    return out;\n}\n\n\nfunction elementAttributes( node ){\n\n    let out = {};\n    let attrs = node.attributes;\n    for(var i = attrs.length - 1; i >= 0; i--) {\n        out[attrs[i].name] = attrs[i].value;\n    }\n    return out;\n}\n\n\nfunction isOnKeepList( node, checkAttr, keepList ){\n\n    let keep = false;\n    if(node.hasAttribute(checkAttr)){\n        let value = node.getAttribute(checkAttr).toLowerCase();\n        if(value.indexOf(' ') > -1){\n            value = value.split(' ');\n        }else{\n            value = [value];\n        }\n        keepList.forEach(function(item){\n            if(value.indexOf(item) > -1){\n                keep = true;\n            }\n        })\n    }\n    return keep;\n}\n\n\nfunction patch( headNode, patch ){\n\n    ['link','patch'].forEach(function(tagName){\n        if(patch[tagName]){\n            patch[tagName].forEach(function(attributes){\n                addNode( headNode, tagName, attributes )\n            });\n        }\n    });\n}\n\n\nfunction addNode( parentNode, tagName, attributes ){\n\n    let newNode = document.createElement(tagName);\n    for(let key in attributes){\n        if(attributes.hasOwnProperty(key)){\n            newNode.setAttribute( key, attributes[key]);\n        }\n    }\n    parentNode.appendChild(newNode);\n}\n\n\nmodule.exports = {\n    remove,\n    patch,\n    siteWideLinkTags,\n    siteWideMetaTags\n};","'use strict';\n// Create a range object for efficently rendering strings to elements.\nvar range;\n\nvar doc = typeof document !== 'undefined' && document;\n\nvar testEl = doc ?\n    doc.body || doc.createElement('div') :\n    {};\n\nvar NS_XHTML = 'http://www.w3.org/1999/xhtml';\n\nvar ELEMENT_NODE = 1;\nvar TEXT_NODE = 3;\nvar COMMENT_NODE = 8;\n\n// Fixes <https://github.com/patrick-steele-idem/morphdom/issues/32>\n// (IE7+ support) <=IE7 does not support el.hasAttribute(name)\nvar hasAttributeNS;\n\nif (testEl.hasAttributeNS) {\n    hasAttributeNS = function(el, namespaceURI, name) {\n        return el.hasAttributeNS(namespaceURI, name);\n    };\n} else if (testEl.hasAttribute) {\n    hasAttributeNS = function(el, namespaceURI, name) {\n        return el.hasAttribute(name);\n    };\n} else {\n    hasAttributeNS = function(el, namespaceURI, name) {\n        return !!el.getAttributeNode(name);\n    };\n}\n\nfunction toElement(str) {\n    if (!range && doc.createRange) {\n        range = doc.createRange();\n        range.selectNode(doc.body);\n    }\n\n    var fragment;\n    if (range && range.createContextualFragment) {\n        fragment = range.createContextualFragment(str);\n    } else {\n        fragment = doc.createElement('body');\n        fragment.innerHTML = str;\n    }\n    return fragment.childNodes[0];\n}\n\nfunction syncBooleanAttrProp(fromEl, toEl, name) {\n    if (fromEl[name] !== toEl[name]) {\n        fromEl[name] = toEl[name];\n        if (fromEl[name]) {\n            fromEl.setAttribute(name, '');\n        } else {\n            fromEl.removeAttribute(name, '');\n        }\n    }\n}\n\nvar specialElHandlers = {\n    /**\n     * Needed for IE. Apparently IE doesn't think that \"selected\" is an\n     * attribute when reading over the attributes using selectEl.attributes\n     */\n    OPTION: function(fromEl, toEl) {\n        syncBooleanAttrProp(fromEl, toEl, 'selected');\n    },\n    /**\n     * The \"value\" attribute is special for the <input> element since it sets\n     * the initial value. Changing the \"value\" attribute without changing the\n     * \"value\" property will have no effect since it is only used to the set the\n     * initial value.  Similar for the \"checked\" attribute, and \"disabled\".\n     */\n    INPUT: function(fromEl, toEl) {\n        syncBooleanAttrProp(fromEl, toEl, 'checked');\n        syncBooleanAttrProp(fromEl, toEl, 'disabled');\n\n        if (fromEl.value !== toEl.value) {\n            fromEl.value = toEl.value;\n        }\n\n        if (!hasAttributeNS(toEl, null, 'value')) {\n            fromEl.removeAttribute('value');\n        }\n    },\n\n    TEXTAREA: function(fromEl, toEl) {\n        var newValue = toEl.value;\n        if (fromEl.value !== newValue) {\n            fromEl.value = newValue;\n        }\n\n        if (fromEl.firstChild) {\n            fromEl.firstChild.nodeValue = newValue;\n        }\n    }\n};\n\nfunction noop() {}\n\n/**\n * Returns true if two node's names are the same.\n *\n * NOTE: We don't bother checking `namespaceURI` because you will never find two HTML elements with the same\n *       nodeName and different namespace URIs.\n *\n * @param {Element} a\n * @param {Element} b The target element\n * @return {boolean}\n */\nfunction compareNodeNames(fromEl, toEl) {\n    var fromNodeName = fromEl.nodeName;\n    var toNodeName = toEl.nodeName;\n\n    if (fromNodeName === toNodeName) {\n        return true;\n    }\n\n    if (toEl.actualize &&\n        fromNodeName.charCodeAt(0) < 91 && /* from tag name is upper case */\n        toNodeName.charCodeAt(0) > 90 /* target tag name is lower case */) {\n        // If the target element is a virtual DOM node then we may need to normalize the tag name\n        // before comparing. Normal HTML elements that are in the \"http://www.w3.org/1999/xhtml\"\n        // are converted to upper case\n        return fromNodeName === toNodeName.toUpperCase();\n    } else {\n        return false;\n    }\n}\n\n/**\n * Create an element, optionally with a known namespace URI.\n *\n * @param {string} name the element name, e.g. 'div' or 'svg'\n * @param {string} [namespaceURI] the element's namespace URI, i.e. the value of\n * its `xmlns` attribute or its inferred namespace.\n *\n * @return {Element}\n */\nfunction createElementNS(name, namespaceURI) {\n    return !namespaceURI || namespaceURI === NS_XHTML ?\n        doc.createElement(name) :\n        doc.createElementNS(namespaceURI, name);\n}\n\n/**\n * Loop over all of the attributes on the target node and make sure the original\n * DOM node has the same attributes. If an attribute found on the original node\n * is not on the new node then remove it from the original node.\n *\n * @param  {Element} fromNode\n * @param  {Element} toNode\n */\nfunction morphAttrs(fromNode, toNode) {\n    var attrs = toNode.attributes;\n    var i;\n    var attr;\n    var attrName;\n    var attrNamespaceURI;\n    var attrValue;\n    var fromValue;\n\n    if (toNode.assignAttributes) {\n        toNode.assignAttributes(fromNode);\n    } else {\n        for (i = attrs.length - 1; i >= 0; --i) {\n            attr = attrs[i];\n            attrName = attr.name;\n            attrNamespaceURI = attr.namespaceURI;\n            attrValue = attr.value;\n\n            if (attrNamespaceURI) {\n                attrName = attr.localName || attrName;\n                fromValue = fromNode.getAttributeNS(attrNamespaceURI, attrName);\n\n                if (fromValue !== attrValue) {\n                    fromNode.setAttributeNS(attrNamespaceURI, attrName, attrValue);\n                }\n            } else {\n                fromValue = fromNode.getAttribute(attrName);\n\n                if (fromValue !== attrValue) {\n                    fromNode.setAttribute(attrName, attrValue);\n                }\n            }\n        }\n    }\n\n    // Remove any extra attributes found on the original DOM element that\n    // weren't found on the target element.\n    attrs = fromNode.attributes;\n\n    for (i = attrs.length - 1; i >= 0; --i) {\n        attr = attrs[i];\n        if (attr.specified !== false) {\n            attrName = attr.name;\n            attrNamespaceURI = attr.namespaceURI;\n\n            if (attrNamespaceURI) {\n                attrName = attr.localName || attrName;\n\n                if (!hasAttributeNS(toNode, attrNamespaceURI, attrName)) {\n                    fromNode.removeAttributeNS(attrNamespaceURI, attrName);\n                }\n            } else {\n                if (!hasAttributeNS(toNode, null, attrName)) {\n                    fromNode.removeAttribute(attrName);\n                }\n            }\n        }\n    }\n}\n\n/**\n * Copies the children of one DOM element to another DOM element\n */\nfunction moveChildren(fromEl, toEl) {\n    var curChild = fromEl.firstChild;\n    while (curChild) {\n        var nextChild = curChild.nextSibling;\n        toEl.appendChild(curChild);\n        curChild = nextChild;\n    }\n    return toEl;\n}\n\nfunction defaultGetNodeKey(node) {\n    return node.id;\n}\n\nfunction morphdom(fromNode, toNode, options) {\n    if (!options) {\n        options = {};\n    }\n\n    if (typeof toNode === 'string') {\n        if (fromNode.nodeName === '#document' || fromNode.nodeName === 'HTML') {\n            var toNodeHtml = toNode;\n            toNode = doc.createElement('html');\n            toNode.innerHTML = toNodeHtml;\n        } else {\n            toNode = toElement(toNode);\n        }\n    }\n\n    var getNodeKey = options.getNodeKey || defaultGetNodeKey;\n    var onBeforeNodeAdded = options.onBeforeNodeAdded || noop;\n    var onNodeAdded = options.onNodeAdded || noop;\n    var onBeforeElUpdated = options.onBeforeElUpdated || noop;\n    var onElUpdated = options.onElUpdated || noop;\n    var onBeforeNodeDiscarded = options.onBeforeNodeDiscarded || noop;\n    var onNodeDiscarded = options.onNodeDiscarded || noop;\n    var onBeforeElChildrenUpdated = options.onBeforeElChildrenUpdated || noop;\n    var childrenOnly = options.childrenOnly === true;\n\n    // This object is used as a lookup to quickly find all keyed elements in the original DOM tree.\n    var fromNodesLookup = {};\n    var keyedRemovalList;\n\n    function addKeyedRemoval(key) {\n        if (keyedRemovalList) {\n            keyedRemovalList.push(key);\n        } else {\n            keyedRemovalList = [key];\n        }\n    }\n\n    function walkDiscardedChildNodes(node, skipKeyedNodes) {\n        if (node.nodeType === ELEMENT_NODE) {\n            var curChild = node.firstChild;\n            while (curChild) {\n\n                var key = undefined;\n\n                if (skipKeyedNodes && (key = getNodeKey(curChild))) {\n                    // If we are skipping keyed nodes then we add the key\n                    // to a list so that it can be handled at the very end.\n                    addKeyedRemoval(key);\n                } else {\n                    // Only report the node as discarded if it is not keyed. We do this because\n                    // at the end we loop through all keyed elements that were unmatched\n                    // and then discard them in one final pass.\n                    onNodeDiscarded(curChild);\n                    if (curChild.firstChild) {\n                        walkDiscardedChildNodes(curChild, skipKeyedNodes);\n                    }\n                }\n\n                curChild = curChild.nextSibling;\n            }\n        }\n    }\n\n    /**\n     * Removes a DOM node out of the original DOM\n     *\n     * @param  {Node} node The node to remove\n     * @param  {Node} parentNode The nodes parent\n     * @param  {Boolean} skipKeyedNodes If true then elements with keys will be skipped and not discarded.\n     * @return {undefined}\n     */\n    function removeNode(node, parentNode, skipKeyedNodes) {\n        if (onBeforeNodeDiscarded(node) === false) {\n            return;\n        }\n\n        if (parentNode) {\n            parentNode.removeChild(node);\n        }\n\n        onNodeDiscarded(node);\n        walkDiscardedChildNodes(node, skipKeyedNodes);\n    }\n\n    // // TreeWalker implementation is no faster, but keeping this around in case this changes in the future\n    // function indexTree(root) {\n    //     var treeWalker = document.createTreeWalker(\n    //         root,\n    //         NodeFilter.SHOW_ELEMENT);\n    //\n    //     var el;\n    //     while((el = treeWalker.nextNode())) {\n    //         var key = getNodeKey(el);\n    //         if (key) {\n    //             fromNodesLookup[key] = el;\n    //         }\n    //     }\n    // }\n\n    // // NodeIterator implementation is no faster, but keeping this around in case this changes in the future\n    //\n    // function indexTree(node) {\n    //     var nodeIterator = document.createNodeIterator(node, NodeFilter.SHOW_ELEMENT);\n    //     var el;\n    //     while((el = nodeIterator.nextNode())) {\n    //         var key = getNodeKey(el);\n    //         if (key) {\n    //             fromNodesLookup[key] = el;\n    //         }\n    //     }\n    // }\n\n    function indexTree(node) {\n        if (node.nodeType === ELEMENT_NODE) {\n            var curChild = node.firstChild;\n            while (curChild) {\n                var key = getNodeKey(curChild);\n                if (key) {\n                    fromNodesLookup[key] = curChild;\n                }\n\n                // Walk recursively\n                indexTree(curChild);\n\n                curChild = curChild.nextSibling;\n            }\n        }\n    }\n\n    indexTree(fromNode);\n\n    function handleNodeAdded(el) {\n        onNodeAdded(el);\n\n        var curChild = el.firstChild;\n        while (curChild) {\n            var nextSibling = curChild.nextSibling;\n\n            var key = getNodeKey(curChild);\n            if (key) {\n                var unmatchedFromEl = fromNodesLookup[key];\n                if (unmatchedFromEl && compareNodeNames(curChild, unmatchedFromEl)) {\n                    curChild.parentNode.replaceChild(unmatchedFromEl, curChild);\n                    morphEl(unmatchedFromEl, curChild);\n                }\n            }\n\n            handleNodeAdded(curChild);\n            curChild = nextSibling;\n        }\n    }\n\n    function morphEl(fromEl, toEl, childrenOnly) {\n        var toElKey = getNodeKey(toEl);\n        var curFromNodeKey;\n\n        if (toElKey) {\n            // If an element with an ID is being morphed then it is will be in the final\n            // DOM so clear it out of the saved elements collection\n            delete fromNodesLookup[toElKey];\n        }\n\n        if (toNode.isSameNode && toNode.isSameNode(fromNode)) {\n            return;\n        }\n\n        if (!childrenOnly) {\n            if (onBeforeElUpdated(fromEl, toEl) === false) {\n                return;\n            }\n\n            morphAttrs(fromEl, toEl);\n            onElUpdated(fromEl);\n\n            if (onBeforeElChildrenUpdated(fromEl, toEl) === false) {\n                return;\n            }\n        }\n\n        if (fromEl.nodeName !== 'TEXTAREA') {\n            var curToNodeChild = toEl.firstChild;\n            var curFromNodeChild = fromEl.firstChild;\n            var curToNodeKey;\n\n            var fromNextSibling;\n            var toNextSibling;\n            var matchingFromEl;\n\n            outer: while (curToNodeChild) {\n                toNextSibling = curToNodeChild.nextSibling;\n                curToNodeKey = getNodeKey(curToNodeChild);\n\n                while (curFromNodeChild) {\n                    fromNextSibling = curFromNodeChild.nextSibling;\n\n                    if (curToNodeChild.isSameNode && curToNodeChild.isSameNode(curFromNodeChild)) {\n                        curToNodeChild = toNextSibling;\n                        curFromNodeChild = fromNextSibling;\n                        continue outer;\n                    }\n\n                    curFromNodeKey = getNodeKey(curFromNodeChild);\n\n                    var curFromNodeType = curFromNodeChild.nodeType;\n\n                    var isCompatible = undefined;\n\n                    if (curFromNodeType === curToNodeChild.nodeType) {\n                        if (curFromNodeType === ELEMENT_NODE) {\n                            // Both nodes being compared are Element nodes\n\n                            if (curToNodeKey) {\n                                // The target node has a key so we want to match it up with the correct element\n                                // in the original DOM tree\n                                if (curToNodeKey !== curFromNodeKey) {\n                                    // The current element in the original DOM tree does not have a matching key so\n                                    // let's check our lookup to see if there is a matching element in the original\n                                    // DOM tree\n                                    if ((matchingFromEl = fromNodesLookup[curToNodeKey])) {\n                                        if (curFromNodeChild.nextSibling === matchingFromEl) {\n                                            // Special case for single element removals. To avoid removing the original\n                                            // DOM node out of the tree (since that can break CSS transitions, etc.),\n                                            // we will instead discard the current node and wait until the next\n                                            // iteration to properly match up the keyed target element with its matching\n                                            // element in the original tree\n                                            isCompatible = false;\n                                        } else {\n                                            // We found a matching keyed element somewhere in the original DOM tree.\n                                            // Let's moving the original DOM node into the current position and morph\n                                            // it.\n\n                                            // NOTE: We use insertBefore instead of replaceChild because we want to go through\n                                            // the `removeNode()` function for the node that is being discarded so that\n                                            // all lifecycle hooks are correctly invoked\n                                            fromEl.insertBefore(matchingFromEl, curFromNodeChild);\n\n                                            if (curFromNodeKey) {\n                                                // Since the node is keyed it might be matched up later so we defer\n                                                // the actual removal to later\n                                                addKeyedRemoval(curFromNodeKey);\n                                            } else {\n                                                // NOTE: we skip nested keyed nodes from being removed since there is\n                                                //       still a chance they will be matched up later\n                                                removeNode(curFromNodeChild, fromEl, true /* skip keyed nodes */);\n\n                                            }\n                                            fromNextSibling = curFromNodeChild.nextSibling;\n                                            curFromNodeChild = matchingFromEl;\n                                        }\n                                    } else {\n                                        // The nodes are not compatible since the \"to\" node has a key and there\n                                        // is no matching keyed node in the source tree\n                                        isCompatible = false;\n                                    }\n                                }\n                            } else if (curFromNodeKey) {\n                                // The original has a key\n                                isCompatible = false;\n                            }\n\n                            isCompatible = isCompatible !== false && compareNodeNames(curFromNodeChild, curToNodeChild);\n                            if (isCompatible) {\n                                // We found compatible DOM elements so transform\n                                // the current \"from\" node to match the current\n                                // target DOM node.\n                                morphEl(curFromNodeChild, curToNodeChild);\n                            }\n\n                        } else if (curFromNodeType === TEXT_NODE || curFromNodeType == COMMENT_NODE) {\n                            // Both nodes being compared are Text or Comment nodes\n                            isCompatible = true;\n                            // Simply update nodeValue on the original node to\n                            // change the text value\n                            curFromNodeChild.nodeValue = curToNodeChild.nodeValue;\n                        }\n                    }\n\n                    if (isCompatible) {\n                        // Advance both the \"to\" child and the \"from\" child since we found a match\n                        curToNodeChild = toNextSibling;\n                        curFromNodeChild = fromNextSibling;\n                        continue outer;\n                    }\n\n                    // No compatible match so remove the old node from the DOM and continue trying to find a\n                    // match in the original DOM. However, we only do this if the from node is not keyed\n                    // since it is possible that a keyed node might match up with a node somewhere else in the\n                    // target tree and we don't want to discard it just yet since it still might find a\n                    // home in the final DOM tree. After everything is done we will remove any keyed nodes\n                    // that didn't find a home\n                    if (curFromNodeKey) {\n                        // Since the node is keyed it might be matched up later so we defer\n                        // the actual removal to later\n                        addKeyedRemoval(curFromNodeKey);\n                    } else {\n                        // NOTE: we skip nested keyed nodes from being removed since there is\n                        //       still a chance they will be matched up later\n                        removeNode(curFromNodeChild, fromEl, true /* skip keyed nodes */);\n                    }\n\n                    curFromNodeChild = fromNextSibling;\n                }\n\n                // If we got this far then we did not find a candidate match for\n                // our \"to node\" and we exhausted all of the children \"from\"\n                // nodes. Therefore, we will just append the current \"to\" node\n                // to the end\n                if (curToNodeKey && (matchingFromEl = fromNodesLookup[curToNodeKey]) && compareNodeNames(matchingFromEl, curToNodeChild)) {\n                    fromEl.appendChild(matchingFromEl);\n                    morphEl(matchingFromEl, curToNodeChild);\n                } else {\n                    var onBeforeNodeAddedResult = onBeforeNodeAdded(curToNodeChild);\n                    if (onBeforeNodeAddedResult !== false) {\n                        if (onBeforeNodeAddedResult) {\n                            curToNodeChild = onBeforeNodeAddedResult;\n                        }\n\n                        if (curToNodeChild.actualize) {\n                            curToNodeChild = curToNodeChild.actualize(fromEl.ownerDocument || doc);\n                        }\n                        fromEl.appendChild(curToNodeChild);\n                        handleNodeAdded(curToNodeChild);\n                    }\n                }\n\n                curToNodeChild = toNextSibling;\n                curFromNodeChild = fromNextSibling;\n            }\n\n            // We have processed all of the \"to nodes\". If curFromNodeChild is\n            // non-null then we still have some from nodes left over that need\n            // to be removed\n            while (curFromNodeChild) {\n                fromNextSibling = curFromNodeChild.nextSibling;\n                if ((curFromNodeKey = getNodeKey(curFromNodeChild))) {\n                    // Since the node is keyed it might be matched up later so we defer\n                    // the actual removal to later\n                    addKeyedRemoval(curFromNodeKey);\n                } else {\n                    // NOTE: we skip nested keyed nodes from being removed since there is\n                    //       still a chance they will be matched up later\n                    removeNode(curFromNodeChild, fromEl, true /* skip keyed nodes */);\n                }\n                curFromNodeChild = fromNextSibling;\n            }\n        }\n\n        var specialElHandler = specialElHandlers[fromEl.nodeName];\n        if (specialElHandler) {\n            specialElHandler(fromEl, toEl);\n        }\n    } // END: morphEl(...)\n\n    var morphedNode = fromNode;\n    var morphedNodeType = morphedNode.nodeType;\n    var toNodeType = toNode.nodeType;\n\n    if (!childrenOnly) {\n        // Handle the case where we are given two DOM nodes that are not\n        // compatible (e.g. <div> --> <span> or <div> --> TEXT)\n        if (morphedNodeType === ELEMENT_NODE) {\n            if (toNodeType === ELEMENT_NODE) {\n                if (!compareNodeNames(fromNode, toNode)) {\n                    onNodeDiscarded(fromNode);\n                    morphedNode = moveChildren(fromNode, createElementNS(toNode.nodeName, toNode.namespaceURI));\n                }\n            } else {\n                // Going from an element node to a text node\n                morphedNode = toNode;\n            }\n        } else if (morphedNodeType === TEXT_NODE || morphedNodeType === COMMENT_NODE) { // Text or comment node\n            if (toNodeType === morphedNodeType) {\n                morphedNode.nodeValue = toNode.nodeValue;\n                return morphedNode;\n            } else {\n                // Text node to something else\n                morphedNode = toNode;\n            }\n        }\n    }\n\n    if (morphedNode === toNode) {\n        // The \"to node\" was not compatible with the \"from node\" so we had to\n        // toss out the \"from node\" and use the \"to node\"\n        onNodeDiscarded(fromNode);\n    } else {\n        morphEl(morphedNode, toNode, childrenOnly);\n\n        // We now need to loop over any keyed nodes that might need to be\n        // removed. We only do the removal if we know that the keyed node\n        // never found a match. When a keyed node is matched up we remove\n        // it out of fromNodesLookup and we use fromNodesLookup to determine\n        // if a keyed node has been matched up or not\n        if (keyedRemovalList) {\n            for (var i=0, len=keyedRemovalList.length; i<len; i++) {\n                var elToRemove = fromNodesLookup[keyedRemovalList[i]];\n                if (elToRemove) {\n                    removeNode(elToRemove, elToRemove.parentNode, false);\n                }\n            }\n        }\n    }\n\n    if (!childrenOnly && morphedNode !== fromNode && fromNode.parentNode) {\n        if (morphedNode.actualize) {\n            morphedNode = morphedNode.actualize(fromNode.ownerDocument || doc);\n        }\n        // If we had to swap out the from node with a new node because the old\n        // node was not compatible with the target node then we need to\n        // replace the old DOM node in the original DOM tree. This is only\n        // possible if the original DOM node was part of a DOM tree which\n        // we know is the case if it has a parent node.\n        fromNode.parentNode.replaceChild(morphedNode, fromNode);\n    }\n\n    return morphedNode;\n}\n\nmodule.exports = morphdom;\n","'use strict';\n\nimport Utils from '../utils.js';\nimport Messaging from './messaging.js';\nimport Head from './head.js';\nimport PatchDOM from 'morphdom';\n\n\n\n// The module pattern\nvar GhostWorkerDOM = function () {\n\n    var m = {};\n    m.cacheName = 'ghostworker';\n    m.contentEvent = new Event('GhostWorkerLoaded');\n    m.contentDOMLoadedEvent = new Event('GhostWorkerDOMContentLoaded');\n\n    m.create = function () {\n\n        var self = this;\n        var url = document.location.href;\n        //this.createJSON(document, url);\n\n        Messaging.getRouteData(url).then(function (data) {\n\n            if (data) {\n                self.createJSON(document, url, data.version);\n                // check for base template\n                self.match(Utils.urlReplacePath(url, data.baseTemplate.templatePath), '-template').then(function (response) {\n                    // create base template first\n                    if (response.error) {\n                        self.createTemplate(document, url, data.baseTemplate, data.version);\n                    }\n                    // then build route template\n                    self.createTemplate(document, url, data.routeData.template, data.version);\n                });\n            } else {\n                this.createTemplate(document, url, null, data.version);\n            }\n            // fire off as we have all the HTML loaded before we create templates\n            document.dispatchEvent(self.contentDOMLoadedEvent);\n        });\n    };\n\n    m.hasTemplate = function (url) {\n\n        var self = this;\n\n        return Messaging.getRouteData(url).then(function (data) {\n            var request = self.newRequest(Utils.urlReplacePath(url, data.routeData.template.templatePath), {});\n            return window.caches.match(request);\n        }).then(function (response) {\n            return response ? true : false;\n        });\n    };\n\n    // creates JSON from full DOM\n    m.createJSON = function (doc, url, version) {\n\n        // create json object\n        var self = this;\n        var out = {};\n        out.replacements = [];\n        //var routeData = Messaging.getRouteData( url );\n\n        return Messaging.getRouteData(url).then(function (data) {\n\n            var template = data.routeData.template;\n            template.elements.forEach(function (selector) {\n                var nodeList = doc.querySelectorAll(selector);\n                var item = {\n                    selector: selector,\n                    content: []\n                };\n                if (nodeList) {\n                    for (var i = 0; i < nodeList.length; ++i) {\n                        item.content.push(nodeList[i].outerHTML);\n                    }\n                }\n                out.replacements.push(item);\n            });\n            Object.assign(out, Head.remove(doc.querySelector('head')));\n\n            var headers = new Headers();\n            headers.append('X-Ghost-Worker-Cache-Date', new Date().toISOString());\n            self.jsonRequest = self.newRequest(Utils.urlJoinPath(url, '-json'), { 'headers': headers });\n            self.jsonResponse = self.newResponse(JSON.stringify(out), 'application/json');\n            self.put(self.cacheName + '-' + template.slug + '-v' + version, self.jsonRequest, self.jsonResponse);\n\n            return out;\n        }).catch(function (reason) {\n            console.log('createJSON: ' + reason);\n        });\n\n        //return out;\n    };\n\n    // creates template from full DOM\n    m.createTemplate = function (doc, url, routeData, version) {\n\n        // create html template\n        var self = this;\n        var out = {};\n        out.replacements = [];\n\n        // check if routeData is object if so resolve directly if not go get it\n        return (routeData ? Promise.resolve(routeData) : Messaging.getRouteData(url)).then(function (routeData) {\n\n            var newDoc = document.documentElement.cloneNode(true);\n            self.removeGhostworkerScript(newDoc);\n            self.clearElements(newDoc, routeData.elements);\n\n            // remove meta and link values from page that need updating with data\n            Head.remove(newDoc.querySelector('head'));\n\n            var headers = new Headers();\n            headers.append('X-Ghost-Worker-Cache-Date', new Date().toISOString());\n            self.templateRequest = self.newRequest(Utils.urlReplacePath(url, routeData.templatePath), { 'headers': headers });\n            self.templateResponse = self.newResponse(newDoc.outerHTML, 'text/html');\n            self.put(self.cacheName + '-template-v' + version, self.templateRequest, self.templateResponse);\n            return newDoc.outerHTML;\n        }).catch(function (reason) {\n            console.log('createTemplate: ' + reason);\n        });\n    };\n\n    m.clearElements = function (document, elements) {\n        if (elements) {\n            elements.forEach(function (selector) {\n                var nodeList = document.querySelectorAll(selector);\n                if (nodeList) {\n                    for (var i = 0; i < nodeList.length; ++i) {\n                        // leave as innerHTML so we can target element with selector later\n                        nodeList[i].innerHTML = '';\n                    }\n                }\n            });\n        }\n    };\n\n    m.removeGhostworkerScript = function (doc) {\n        var nodeList = doc.querySelectorAll('.ghostworker-script');\n        if (nodeList) {\n            for (var i = 0; i < nodeList.length; ++i) {\n                nodeList[i].parentNode.removeChild(nodeList[i]);\n            }\n        }\n    };\n\n    m.newRequest = function (url, options) {\n        return new Request(url, options);\n    };\n\n    m.newResponse = function (bodyString, type) {\n        var options = {\n            status: 200,\n            statusText: \"OK\",\n            headers: { 'Content-Type': type } // text/html or application/json\n        };\n        return new Response(bodyString, options);\n    };\n\n    m.put = function (cacheName, request, response) {\n        caches.open(cacheName).then(function (cache) {\n            if (request && response) {\n                cache.put(request, response);\n            }\n        });\n    };\n\n    m.match = function (url, options) {\n        var request = this.newRequest(url, options);\n        return caches.match(request).then(function (response) {\n            return response;\n        });\n    };\n\n    // call to add JSON to page\n    m.addJSON = function (url, redrawLevel) {\n\n        var self = this;\n        url = url || document.location.href;\n\n        // get route data\n        Promise.all([\n            Messaging.getSiteData(),\n            Messaging.getRouteData(url)\n        ]).then(function (results) {\n            var siteData = results[0];\n            var data = results[1];\n            var template = data.routeData.template\n\n            // add header so the template logic is not fired in service worker\n            var headers = new Headers();\n            headers.append('X-GhostWorker-Content', 'raw');\n            headers.append('X-GhostWorker-RouteData', JSON.stringify(template));\n\n            var request = new Request(url, { headers: headers });\n\n            // find JSON in cache\n            // *********************************************************************************************************** //\n            self.match(new Request(Utils.urlJoinPath(url, '-json')), '-json').then(function (json) {\n\n                // has a site template info\n\n                // does current template match new template\n                if (redrawLevel === 'site') {\n                    // default to base template\n                    self.clearElements(document, data.baseTemplate.elements);\n                    Head.remove(document.querySelector('head'));\n\n                    // load section template from cache\n                    var templateRequest = self.newRequest(Utils.urlReplacePath(url, template.templatePath), {});\n                    // *********************************************************************************************************** //\n                    self.match(templateRequest, '-template').then(function (templateJSON) {\n                        if (!templateJSON || templateJSON.error) {\n                            console.log('addJSON no template found');\n                        } else {\n                            console.log('using a section template')\n                            self.injectTemplateJSON(templateJSON, data.baseTemplate).then(function (done) {\n                                if (!json.error) {\n                                    self.injectJSON(json, true);\n                                }\n                            });\n                        }\n                    });\n                } else {\n                    if (!json.error) {\n                        self.injectJSON(json, true);\n                    }\n                }\n\n                // get it from network inject either to add or update content\n                // *********************************************************************************************************** //\n                self.createJSONFromNetwork(request, data.version).then(function (json) {\n                    if (json && !json.error) {\n                        self.injectJSON(json, false);\n                    } else {\n                        console.log('createJSONFromNetwork');\n                    }\n                }).catch(function (reason) {\n                    console.log('createJSONFromNetwork' + reason);\n                });\n            });\n        }).catch(function (reason) {\n            console.log(reason);\n        });\n    };\n\n    // get JSON form network - downloads HTML and creates JSON structure\n    m.createJSONFromNetwork = function (request, version) {\n\n        var self = this;\n        return fetch(request).then(function (response) {\n\n            if (request.method === 'GET' && response.status > 199 && response.status < 400) {\n\n                return response.text().then(function (body) {\n                    var parser = new DOMParser();\n                    return parser.parseFromString(body, \"text/html\");\n                }).then(function (doc) {\n                    return self.createJSON(doc, request.url, version);\n                });\n            } else {\n                return { error: 'response issue' };\n            }\n        }).catch(function (reason) {\n            console.log('createJSONFromNetwork', reason);\n        });\n    };\n\n    // get  -json or -template responses from cache\n    m.match = function (request, suffix) {\n\n        return window.caches.match(request).then(function (response) {\n\n            if (response) {\n                var clonedResponse = response.clone();\n                if (clonedResponse && clonedResponse.status >= 200 && clonedResponse.status < 400) {\n                    return response.text().then(function (body) {\n                        return suffix === '-json' ? JSON.parse(body) : { 'template': body };\n                    });\n                }\n                return { error: 'response issue' };\n            } else {\n                return { error: 'no match' };\n            }\n        });\n    };\n\n    m.injectTemplateJSON = function (json, baseTemplate) {\n\n        var parser = new DOMParser();\n        var doc = parser.parseFromString(json.template, \"text/html\");\n\n        console.log('injectTemplateJSON');\n\n        baseTemplate.elements.forEach(function (selector) {\n            var destination = document.querySelector(selector);\n            var source = doc.querySelector(selector);\n            if(destination && source){\n                destination.parentNode.replaceChild(source, destination);\n            }else{\n                console.log('issue injecting section template into base template')\n            }\n        });\n        return Promise.resolve();\n\n        // copy elements between documents to recreate a route template\n\n\n        /*\n        return Messaging.getSiteData().then(function (siteDate) {\n            if (siteDate && siteDate.elements) {\n                siteDate.elements.forEach(function (selector) {\n                    var destination = document.querySelector(selector);\n                    var source = doc.querySelector(selector);\n                    destination.parentNode.replaceChild(source, destination);\n                });\n            }\n            return true;\n        });\n        */\n    };\n\n    m.injectJSON = function (json, firstDraw) {\n        var self = this;\n\n        // elements\n        json.replacements.forEach(function (replacement, idx) {\n            var nodeList = document.querySelectorAll(replacement.selector);\n            if (nodeList) {\n                for (var i = 0; i < nodeList.length; ++i) {\n                    if (replacement.content[i]) {\n\n                        // on update this should patch direct from one DOM node to another rather than using JSON html\n                        PatchDOM(nodeList[i], replacement.content[i]);\n\n                        // fire after last modification of DOM from injecting JSON\n                        if (idx === json.replacements.length - 1 && i === nodeList.length - 1) {\n                            document.dispatchEvent(self.contentDOMLoadedEvent);\n                        }\n                    }\n                }\n            }\n        });\n\n        var patchInstructions = {\n            link: json.link,\n            meta: json.meta\n        };\n        Head.patch(document.querySelector('head'), patchInstructions);\n        this.captureLinks();\n    };\n\n    m.captureLinks = function () {\n        var nodeList = document.querySelectorAll('a');\n        if (nodeList) {\n            for (var i = 0; i < nodeList.length; ++i) {\n\n                // browser should not allow binding twice\n                //nodeList[i].removeEventListener('click', this.clickEvent ,true);\n                nodeList[i].addEventListener('click', this.clickEvent, true);\n            }\n        }\n    };\n\n    m.clickEvent = function (e) {\n        console.log('link fired');\n\n        var documentUrl = new URL(document.location.href);\n        var targetUrl = new URL(e.currentTarget.href);\n\n        e.preventDefault();\n\n        Promise.all([Messaging.getRouteData(documentUrl.toString()), Messaging.getRouteData(targetUrl.toString())]).then(function (results) {\n            console.log(JSON.stringify(results));\n\n            var documentData = results[0];\n            var targetData = results[1];\n\n            // both current and target URLs are part of routing system\n            if (documentData && targetData) {\n\n                // they are from the same section - match on section template name\n                if (documentData.routeData.template.templatePath === targetData.routeData.template.templatePath) {\n\n                    console.log('uses same base template - load just json');\n                    GhostWorkerDOM.addJSON(targetUrl.toString(), 'route');\n                    history.pushState({}, '', targetUrl.toString());\n                } else {\n\n                    // route is in system but uses a different base template\n                    GhostWorkerDOM.hasTemplate(targetUrl.toString()).then(function (hasTemplate) {\n                        if (documentData.baseTemplate.name === targetData.baseTemplate.name) {\n                            // same base template just update base template elements\n                            GhostWorkerDOM.addJSON(targetUrl.toString(), 'site');\n                            history.pushState({}, '', targetUrl.toString());\n                        } else {\n                            // full page reload allowing whole dom to redraw and new context for js\n                            console.log('let HTTP request pass through');\n                            document.location.href = targetUrl.toString();\n                        }\n                    });\n                }\n            } else {\n                document.location.href = targetUrl.toString();\n            }\n        }).catch(function (reason) {\n            console.log(reason);\n        });\n    };\n\n    return m;\n}();\n\n\nexport default GhostWorkerDOM\n\n\n"],"names":["removeLastBackslash","path","endsWith","slice","urlJoinPath","url","URL","pathname","toString","urlReplacePath","urlRemoveBackslash","str","match","position","isFinite","Math","floor","length","lastIndex","lastIndexOf","clone","obj","JSON","parse","stringify","Object","assign","target","undefined","TypeError","output","index","arguments","source","nextKey","hasOwnProperty","handleErrors","response","ok","Error","statusText","exports","getDataFromSW","requestOptions","Promise","resolve","reject","messageChannel","MessageChannel","port1","onmessage","event","data","error","serviceWorker","controller","postMessage","port2","getRouteData","then","result","catch","reason","log","getSiteData","getVersion","siteWideLinkTags","siteWideMetaTags","remove","headNode","removeElements","selector","checkAttr","keepList","out","nodeList","querySelectorAll","node","isOnKeepList","push","elementAttributes","removeChild","attrs","attributes","i","name","value","keep","hasAttribute","getAttribute","toLowerCase","indexOf","split","forEach","item","patch","tagName","addNode","parentNode","newNode","document","createElement","key","setAttribute","appendChild","GhostWorkerDOM","m","cacheName","contentEvent","Event","contentDOMLoadedEvent","create","self","location","href","createJSON","version","Utils","baseTemplate","templatePath","createTemplate","routeData","template","dispatchEvent","hasTemplate","Messaging","request","newRequest","window","caches","doc","replacements","elements","content","outerHTML","Head","querySelector","headers","Headers","append","Date","toISOString","jsonRequest","jsonResponse","newResponse","put","slug","newDoc","documentElement","cloneNode","removeGhostworkerScript","clearElements","templateRequest","templateResponse","innerHTML","options","Request","bodyString","type","Response","open","cache","addJSON","redrawLevel","all","results","siteData","json","templateJSON","injectTemplateJSON","done","injectJSON","createJSONFromNetwork","fetch","method","status","text","body","parser","DOMParser","parseFromString","suffix","clonedResponse","destination","replaceChild","firstDraw","replacement","idx","patchInstructions","link","meta","captureLinks","addEventListener","clickEvent","e","documentUrl","targetUrl","currentTarget","preventDefault","documentData","targetData","pushState"],"mappings":"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"}