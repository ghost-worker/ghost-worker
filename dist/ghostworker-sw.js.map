{"version":3,"file":null,"sources":["../lib/utils.js","../lib/serviceworker/router.js","../lib/serviceworker/index.js"],"sourcesContent":["'use strict';\n\nfunction removeLastBackslash( path ){\n    return (endsWith(path , '/'))? path.slice(0, -1) : path;\n}\n\n\nfunction urlJoinPath( url, path ){\n    url = new URL( url );\n    url.pathname = url.pathname + path\n    return url.toString();\n}\n\n\nfunction urlReplacePath( url, path ){\n    url = new URL( url );\n    url.pathname = path\n    return url.toString();\n}\n\n\nfunction urlRemoveBackslash( url ){\n    url = new URL( url );\n    if(endsWith(url.pathname, '/')){\n      url.pathname = url.pathname.slice(0, -1);\n    }\n    return url.toString();\n}\n\n\nfunction endsWith(str, match, position) {\n  if (typeof position !== 'number' || !isFinite(position) || Math.floor(position) !== position || position > str.length) {\n    position = str.length;\n  }\n  position -= match.length;\n  var lastIndex = str.lastIndexOf(match, position);\n  return lastIndex !== -1 && lastIndex === position;\n}\n\n\nfunction clone(obj){\n    // very simple clone, be careful\n    return JSON.parse(JSON.stringify(obj))\n}\n\n\nif (typeof Object.assign != 'function') {\n  (function () {\n    Object.assign = function (target) {\n      'use strict';\n      // We must check against these specific cases.\n      if (target === undefined || target === null) {\n        throw new TypeError('Cannot convert undefined or null to object');\n      }\n\n      var output = Object(target);\n      for (var index = 1; index < arguments.length; index++) {\n        var source = arguments[index];\n        if (source !== undefined && source !== null) {\n          for (var nextKey in source) {\n            if (source.hasOwnProperty(nextKey)) {\n              output[nextKey] = source[nextKey];\n            }\n          }\n        }\n      }\n      return output;\n    };\n  })();\n}\n\n\n// handles fetch errs\nfunction handleErrors(response) {\n    if (!response.ok) {\n        throw Error(response.statusText);\n    }\n    return response;\n}\n\n\nmodule.exports = {\n    removeLastBackslash,\n    urlJoinPath,\n    urlReplacePath,\n    urlRemoveBackslash,\n    endsWith,\n    clone,\n    handleErrors\n};\n","(function (global, factory) {\n\ttypeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n\ttypeof define === 'function' && define.amd ? define(factory) :\n\t(global.HAPIRouter = factory());\n}(this, (function () { 'use strict';\n\nfunction interopDefault(ex) {\n\treturn ex && typeof ex === 'object' && 'default' in ex ? ex['default'] : ex;\n}\n\nfunction createCommonjsModule(fn, module) {\n\treturn module = { exports: {} }, fn(module, module.exports), module.exports;\n}\n\nvar hoek = createCommonjsModule(function (module) {\n    'use strict';\n    // basic replacement for HAPI.js Hoek module\n\n\n    module.exports = {\n\n        applyToDefaults: function applyToDefaults(obj, src) {\n            for (var key in src) {\n                if (src.hasOwnProperty(key)) obj[key] = src[key];\n            }\n            return obj;\n        },\n\n        escapeRegex: function escapeRegex(string) {\n\n            // Escape ^$.*+-?=!:|\\/()[]{},\n            return string.replace(/[\\^\\$\\.\\*\\+\\-\\?\\=\\!\\:\\|\\\\\\/\\(\\)\\[\\]\\{\\}\\,]/g, '\\\\$&');\n        },\n\n        assert: function assert(condition, message) {\n            if (!condition) {\n                throw new Error(message);\n            }\n        }\n    };\n});\n\nvar hoek$1 = interopDefault(hoek);\nvar applyToDefaults = hoek.applyToDefaults;\nvar escapeRegex = hoek.escapeRegex;\nvar assert = hoek.assert;\n\nvar require$$0 = Object.freeze({\n    default: hoek$1,\n    applyToDefaults: applyToDefaults,\n    escapeRegex: escapeRegex,\n    assert: assert\n});\n\nvar boom = createCommonjsModule(function (module) {\n    'use strict';\n    // basic replacement for HAPI.js Boom module\n\n\n    module.exports = {\n\n        notFound: function notFound() {\n\n            return null;\n        },\n\n        badRequest: function badRequest() {\n\n            return null;\n        }\n    };\n});\n\nvar boom$1 = interopDefault(boom);\nvar notFound = boom.notFound;\nvar badRequest = boom.badRequest;\n\nvar require$$2 = Object.freeze({\n    default: boom$1,\n    notFound: notFound,\n    badRequest: badRequest\n});\n\nvar regex = createCommonjsModule(function (module, exports) {\n    'use strict';\n\n    // Load modules\n\n\n    // Declare internals\n\n    var internals = {};\n\n    exports.generate = function () {\n\n        /*\n            /path/{param}/path/{param?}\n            /path/{param*2}/path\n            /path/{param*2}\n            /path/x{param}x\n            /{param*}\n        */\n\n        var empty = '(?:^\\\\/$)';\n\n        var legalChars = '[\\\\w\\\\!\\\\$&\\'\\\\(\\\\)\\\\*\\\\+\\\\,;\\\\=\\\\:@\\\\-\\\\.~]';\n        var encoded = '%[A-F0-9]{2}';\n\n        var literalChar = '(?:' + legalChars + '|' + encoded + ')';\n        var literal = literalChar + '+';\n        var literalOptional = literalChar + '*';\n\n        var midParam = '(?:\\\\{\\\\w+(?:\\\\*[1-9]\\\\d*)?\\\\})'; // {p}, {p*2}\n        var endParam = '(?:\\\\/(?:\\\\{\\\\w+(?:(?:\\\\*(?:[1-9]\\\\d*)?)|(?:\\\\?))?\\\\})?)?'; // {p}, {p*2}, {p*}, {p?}\n\n        var partialParam = '(?:\\\\{\\\\w+\\\\??\\\\})'; // {p}, {p?}\n        var mixedParam = '(?:(?:' + literal + partialParam + ')+' + literalOptional + ')|(?:' + partialParam + '(?:' + literal + partialParam + ')+' + literalOptional + ')|(?:' + partialParam + literal + ')';\n\n        var segmentContent = '(?:' + literal + '|' + midParam + '|' + mixedParam + ')';\n        var segment = '\\\\/' + segmentContent;\n        var segments = '(?:' + segment + ')*';\n\n        var path = '(?:^' + segments + endParam + '$)';\n\n        //                1:literal               2:name   3:*  4:count  5:?\n        var parseParam = '(' + literal + ')|(?:\\\\{(\\\\w+)(?:(\\\\*)(\\\\d+)?)?(\\\\?)?\\\\})';\n\n        var expressions = {\n            parseParam: new RegExp(parseParam, 'g'),\n            validatePath: new RegExp(empty + '|' + path),\n            validatePathEncoded: /%(?:2[146-9A-E]|3[\\dABD]|4[\\dA-F]|5[\\dAF]|6[1-9A-F]|7[\\dAE])/g\n        };\n\n        return expressions;\n    };\n});\n\nvar regex$1 = interopDefault(regex);\nvar generate = regex.generate;\n\nvar require$$1 = Object.freeze({\n    default: regex$1,\n    generate: generate\n});\n\nvar segment = createCommonjsModule(function (module, exports) {\n    'use strict';\n\n    // Load modules\n\n    var Hoek = interopDefault(require$$0);\n\n    // Declare internals\n\n    var internals = {};\n\n    exports = module.exports = internals.Segment = function () {\n\n        this._edge = null; // { segment, record }\n        this._fulls = null; // { path: { segment, record }\n        this._literals = null; // { literal: { segment, <node> } }\n        this._param = null; // <node>\n        this._mixed = null; // [{ segment, <node> }]\n        this._wildcard = null; // { segment, record }\n    };\n\n    internals.Segment.prototype.add = function (segments, record) {\n\n        /*\n            { literal: 'x' }        -> x\n            { empty: false }        -> {p}\n            { wildcard: true }      -> {p*}\n            { mixed: /regex/ }      -> a{p}b\n        */\n\n        var current = segments[0];\n        var remaining = segments.slice(1);\n        var isEdge = !remaining.length;\n\n        var literals = [];\n        var isLiteral = true;\n        for (var i = 0; i < segments.length && isLiteral; ++i) {\n            isLiteral = segments[i].literal !== undefined;\n            literals.push(segments[i].literal);\n        }\n\n        if (isLiteral) {\n            this._fulls = this._fulls || {};\n            var literal = '/' + literals.join('/');\n            if (!record.settings.isCaseSensitive) {\n                literal = literal.toLowerCase();\n            }\n\n            Hoek.assert(!this._fulls[literal], 'New route', record.path, 'conflicts with existing', this._fulls[literal] && this._fulls[literal].record.path);\n            this._fulls[literal] = { segment: current, record: record };\n        } else if (current.literal !== undefined) {\n            // Can be empty string\n\n            // Literal\n\n            this._literals = this._literals || {};\n            var currentLiteral = record.settings.isCaseSensitive ? current.literal : current.literal.toLowerCase();\n            this._literals[currentLiteral] = this._literals[currentLiteral] || new internals.Segment();\n            this._literals[currentLiteral].add(remaining, record);\n        } else if (current.wildcard) {\n\n            // Wildcard\n\n            Hoek.assert(!this._wildcard, 'New route', record.path, 'conflicts with existing', this._wildcard && this._wildcard.record.path);\n            Hoek.assert(!this._param || !this._param._wildcard, 'New route', record.path, 'conflicts with existing', this._param && this._param._wildcard && this._param._wildcard.record.path);\n            this._wildcard = { segment: current, record: record };\n        } else if (current.mixed) {\n\n            // Mixed\n\n            this._mixed = this._mixed || [];\n\n            var mixed = this._mixedLookup(current);\n            if (!mixed) {\n                mixed = { segment: current, node: new internals.Segment() };\n                this._mixed.push(mixed);\n                this._mixed.sort(internals.mixed);\n            }\n\n            if (isEdge) {\n                Hoek.assert(!mixed.node._edge, 'New route', record.path, 'conflicts with existing', mixed.node._edge && mixed.node._edge.record.path);\n                mixed.node._edge = { segment: current, record: record };\n            } else {\n                mixed.node.add(remaining, record);\n            }\n        } else {\n\n            // Parameter\n\n            this._param = this._param || new internals.Segment();\n\n            if (isEdge) {\n                Hoek.assert(!this._param._edge, 'New route', record.path, 'conflicts with existing', this._param._edge && this._param._edge.record.path);\n                this._param._edge = { segment: current, record: record };\n            } else {\n                Hoek.assert(!this._wildcard || !remaining[0].wildcard, 'New route', record.path, 'conflicts with existing', this._wildcard && this._wildcard.record.path);\n                this._param.add(remaining, record);\n            }\n        }\n    };\n\n    internals.Segment.prototype._mixedLookup = function (segment) {\n\n        for (var i = 0; i < this._mixed.length; ++i) {\n            if (internals.mixed({ segment: segment }, this._mixed[i]) === 0) {\n                return this._mixed[i];\n            }\n        }\n\n        return null;\n    };\n\n    internals.mixed = function (a, b) {\n\n        var aFirst = -1;\n        var bFirst = 1;\n\n        var as = a.segment;\n        var bs = b.segment;\n\n        if (as.length !== bs.length) {\n            return as.length > bs.length ? aFirst : bFirst;\n        }\n\n        if (as.first !== bs.first) {\n            return as.first ? bFirst : aFirst;\n        }\n\n        for (var i = 0; i < as.segments.length; ++i) {\n            var am = as.segments[i];\n            var bm = bs.segments[i];\n\n            if (am === bm) {\n                continue;\n            }\n\n            if (am.length === bm.length) {\n                return am > bm ? bFirst : aFirst;\n            }\n\n            return am.length < bm.length ? bFirst : aFirst;\n        }\n\n        return 0;\n    };\n\n    internals.Segment.prototype.lookup = function (path, segments, options) {\n\n        var match = null;\n\n        // Literal edge\n\n        if (this._fulls) {\n            match = this._fulls[options.isCaseSensitive ? path : path.toLowerCase()];\n            if (match) {\n                return { record: match.record, array: [] };\n            }\n        }\n\n        // Literal node\n\n        var current = segments[0];\n        var nextPath = path.slice(current.length + 1);\n        var remainder = segments.length > 1 ? segments.slice(1) : null;\n\n        if (this._literals) {\n            var literal = options.isCaseSensitive ? current : current.toLowerCase();\n            match = this._literals.hasOwnProperty(literal) && this._literals[literal];\n            if (match) {\n                var record = internals.deeper(match, nextPath, remainder, [], options);\n                if (record) {\n                    return record;\n                }\n            }\n        }\n\n        // Mixed\n\n        if (this._mixed) {\n            for (var i = 0; i < this._mixed.length; ++i) {\n                match = this._mixed[i];\n                var params = current.match(match.segment.mixed);\n                if (params) {\n                    var array = [];\n                    for (var j = 1; j < params.length; ++j) {\n                        array.push(params[j]);\n                    }\n\n                    var _record = internals.deeper(match.node, nextPath, remainder, array, options);\n                    if (_record) {\n                        return _record;\n                    }\n                }\n            }\n        }\n\n        // Param\n\n        if (this._param) {\n            if (current || this._param._edge && this._param._edge.segment.empty) {\n\n                var _record2 = internals.deeper(this._param, nextPath, remainder, [current], options);\n                if (_record2) {\n                    return _record2;\n                }\n            }\n        }\n\n        // Wildcard\n\n        if (this._wildcard) {\n            return { record: this._wildcard.record, array: [path.slice(1)] };\n        }\n\n        return null;\n    };\n\n    internals.deeper = function (match, path, segments, array, options) {\n\n        if (!segments) {\n            if (match._edge) {\n                return { record: match._edge.record, array: array };\n            }\n\n            if (match._wildcard) {\n                return { record: match._wildcard.record, array: array };\n            }\n        } else {\n            var result = match.lookup(path, segments, options);\n            if (result) {\n                return { record: result.record, array: array.concat(result.array) };\n            }\n        }\n\n        return null;\n    };\n});\n\nvar segment$1 = interopDefault(segment);\n\nvar require$$0$1 = Object.freeze({\n    default: segment$1\n});\n\nvar index = createCommonjsModule(function (module, exports) {\n    'use strict';\n\n    // Load modules\n\n    var Hoek = interopDefault(require$$0);\n    var Boom = interopDefault(require$$2);\n    var Regex = interopDefault(require$$1);\n    var Segment = interopDefault(require$$0$1);\n\n    // Declare internals\n\n    var internals = {\n        pathRegex: Regex.generate(),\n        defaults: {\n            isCaseSensitive: true\n        }\n    };\n\n    exports.Router = internals.Router = function (options) {\n\n        this.settings = Hoek.applyToDefaults(internals.defaults, options || {});\n\n        this.routes = {}; // Key: HTTP method or * for catch-all, value: sorted array of routes\n        this.ids = {}; // Key: route id, value: record\n        this.vhosts = null; // {} where Key: hostname, value: see this.routes\n\n        this.specials = {\n            badRequest: null,\n            notFound: null,\n            options: null\n        };\n    };\n\n    internals.Router.prototype.add = function (config, route) {\n\n        var method = config.method.toLowerCase();\n\n        var vhost = config.vhost || '*';\n        if (vhost !== '*') {\n            this.vhosts = this.vhosts || {};\n            this.vhosts[vhost] = this.vhosts[vhost] || {};\n        }\n\n        var table = vhost === '*' ? this.routes : this.vhosts[vhost];\n        table[method] = table[method] || { routes: [], router: new Segment() };\n\n        var analysis = config.analysis || this.analyze(config.path);\n        var record = {\n            path: config.path,\n            route: route || config.path,\n            segments: analysis.segments,\n            params: analysis.params,\n            fingerprint: analysis.fingerprint,\n            settings: this.settings\n        };\n\n        // Add route\n\n        table[method].router.add(analysis.segments, record);\n        table[method].routes.push(record);\n        table[method].routes.sort(internals.sort);\n\n        var last = record.segments[record.segments.length - 1];\n        if (last.empty) {\n            table[method].router.add(analysis.segments.slice(0, -1), record);\n        }\n\n        if (config.id) {\n            Hoek.assert(!this.ids[config.id], 'Route id', config.id, 'for path', config.path, 'conflicts with existing path', this.ids[config.id] && this.ids[config.id].path);\n            this.ids[config.id] = record;\n        }\n\n        return record;\n    };\n\n    internals.Router.prototype.special = function (type, route) {\n\n        Hoek.assert(Object.keys(this.specials).indexOf(type) !== -1, 'Unknown special route type:', type);\n\n        this.specials[type] = { route: route };\n    };\n\n    internals.Router.prototype.route = function (method, path, hostname) {\n\n        var segments = path.split('/').slice(1);\n\n        var vhost = this.vhosts && hostname && this.vhosts[hostname];\n        var route = vhost && this._lookup(path, segments, vhost, method) || this._lookup(path, segments, this.routes, method) || method === 'head' && vhost && this._lookup(path, segments, vhost, 'get') || method === 'head' && this._lookup(path, segments, this.routes, 'get') || method === 'options' && this.specials.options || vhost && this._lookup(path, segments, vhost, '*') || this._lookup(path, segments, this.routes, '*') || this.specials.notFound || Boom.notFound();\n\n        return route;\n    };\n\n    internals.Router.prototype._lookup = function (path, segments, table, method) {\n\n        var set = table[method];\n        if (!set) {\n            return null;\n        }\n\n        var match = set.router.lookup(path, segments, this.settings);\n        if (!match) {\n            return null;\n        }\n\n        var assignments = {};\n        var array = [];\n        for (var i = 0; i < match.array.length; ++i) {\n            var name = match.record.params[i];\n            var value = match.array[i];\n            if (value) {\n                value = internals.decode(value);\n                if (value.isBoom) {\n                    return this.specials.badRequest || value;\n                }\n\n                if (assignments[name] !== undefined) {\n                    assignments[name] = assignments[name] + '/' + value;\n                } else {\n                    assignments[name] = value;\n                }\n\n                if (i + 1 === match.array.length || name !== match.record.params[i + 1]) {\n\n                    array.push(assignments[name]);\n                }\n            }\n        }\n\n        return { params: assignments, paramsArray: array, route: match.record.route };\n    };\n\n    internals.decode = function (value) {\n\n        try {\n            return decodeURIComponent(value);\n        } catch (err) {\n            return Boom.badRequest('Invalid request path');\n        }\n    };\n\n    internals.Router.prototype.normalize = function (path) {\n\n        if (path && path.indexOf('%') !== -1) {\n\n            // Uppercase %encoded values\n\n            var uppercase = path.replace(/%[0-9a-fA-F][0-9a-fA-F]/g, function (encoded) {\n                return encoded.toUpperCase();\n            });\n\n            // Decode non-reserved path characters: a-z A-Z 0-9 _!$&'()*+,;=:@-.~\n            // ! (%21) $ (%24) & (%26) ' (%27) ( (%28) ) (%29) * (%2A) + (%2B) , (%2C) - (%2D) . (%2E)\n            // 0-9 (%30-39) : (%3A) ; (%3B) = (%3D)\n            // @ (%40) A-Z (%41-5A) _ (%5F) a-z (%61-7A) ~ (%7E)\n\n            var decoded = uppercase.replace(/%(?:2[146-9A-E]|3[\\dABD]|4[\\dA-F]|5[\\dAF]|6[1-9A-F]|7[\\dAE])/g, function (encoded) {\n                return String.fromCharCode(parseInt(encoded.substring(1), 16));\n            });\n\n            path = decoded;\n        }\n\n        return path;\n    };\n\n    internals.Router.prototype.analyze = function (path) {\n\n        Hoek.assert(internals.pathRegex.validatePath.test(path), 'Invalid path:', path);\n        Hoek.assert(!internals.pathRegex.validatePathEncoded.test(path), 'Path cannot contain encoded non-reserved path characters:', path);\n\n        var pathParts = path.split('/');\n        var segments = [];\n        var params = [];\n        var fingers = [];\n\n        for (var i = 1; i < pathParts.length; ++i) {\n            // Skip first empty segment\n            var segment = pathParts[i];\n\n            // Literal\n\n            if (segment.indexOf('{') === -1) {\n                segment = this.settings.isCaseSensitive ? segment : segment.toLowerCase();\n                fingers.push(segment);\n                segments.push({ literal: segment });\n                continue;\n            }\n\n            // Parameter\n\n            var parts = internals.parseParams(segment);\n            if (parts.length === 1) {\n\n                // Simple parameter\n\n                var item = parts[0];\n                Hoek.assert(params.indexOf(item.name) === -1, 'Cannot repeat the same parameter name:', item.name, 'in:', path);\n                params.push(item.name);\n\n                if (item.wilcard) {\n                    if (item.count) {\n                        for (var j = 0; j < item.count; ++j) {\n                            fingers.push('?');\n                            segments.push({});\n                            if (j) {\n                                params.push(item.name);\n                            }\n                        }\n                    } else {\n                        fingers.push('#');\n                        segments.push({ wildcard: true });\n                    }\n                } else {\n                    fingers.push('?');\n                    segments.push({ empty: item.empty });\n                }\n            } else {\n\n                // Mixed parameter\n\n                var seg = {\n                    length: parts.length,\n                    first: typeof parts[0] !== 'string',\n                    segments: []\n                };\n\n                var finger = '';\n                var regex = '^';\n                for (var _j = 0; _j < parts.length; ++_j) {\n                    var part = parts[_j];\n                    if (typeof part === 'string') {\n                        finger = finger + part;\n                        regex = regex + Hoek.escapeRegex(part);\n                        seg.segments.push(part);\n                    } else {\n                        Hoek.assert(params.indexOf(part.name) === -1, 'Cannot repeat the same parameter name:', part.name, 'in:', path);\n                        params.push(part.name);\n\n                        finger = finger + '?';\n                        regex = regex + '(.' + (part.empty ? '*' : '+') + ')';\n                    }\n                }\n\n                seg.mixed = new RegExp(regex + '$', !this.settings.isCaseSensitive ? 'i' : '');\n                fingers.push(finger);\n                segments.push(seg);\n            }\n        }\n\n        return {\n            segments: segments,\n            fingerprint: '/' + fingers.join('/'),\n            params: params\n        };\n    };\n\n    internals.parseParams = function (segment) {\n\n        var parts = [];\n        segment.replace(internals.pathRegex.parseParam, function (match, literal, name, wilcard, count, empty) {\n\n            if (literal) {\n                parts.push(literal);\n            } else {\n                parts.push({\n                    name: name,\n                    wilcard: !!wilcard,\n                    count: count && parseInt(count, 10),\n                    empty: !!empty\n                });\n            }\n\n            return '';\n        });\n\n        return parts;\n    };\n\n    internals.Router.prototype.table = function (host) {\n\n        var result = [];\n        var collect = function collect(table) {\n\n            if (!table) {\n                return;\n            }\n\n            Object.keys(table).forEach(function (method) {\n\n                table[method].routes.forEach(function (record) {\n\n                    result.push(record.route);\n                });\n            });\n        };\n\n        if (this.vhosts) {\n            var vhosts = host ? [].concat(host) : Object.keys(this.vhosts);\n            for (var i = 0; i < vhosts.length; ++i) {\n                collect(this.vhosts[vhosts[i]]);\n            }\n        }\n\n        collect(this.routes);\n\n        return result;\n    };\n\n    internals.sort = function (a, b) {\n\n        var aFirst = -1;\n        var bFirst = 1;\n\n        var as = a.segments;\n        var bs = b.segments;\n\n        if (as.length !== bs.length) {\n            return as.length > bs.length ? bFirst : aFirst;\n        }\n\n        for (var i = 0;; ++i) {\n            if (as[i].literal) {\n                if (bs[i].literal) {\n                    if (as[i].literal === bs[i].literal) {\n                        continue;\n                    }\n\n                    return as[i].literal > bs[i].literal ? bFirst : aFirst;\n                }\n                return aFirst;\n            } else if (bs[i].literal) {\n                return bFirst;\n            }\n\n            return as[i].wildcard ? bFirst : aFirst;\n        }\n    };\n});\n\nvar CallRouter = interopDefault(index);\n\n// pulls in node module and export with rollup\n\nfunction urltoPath(url) {\n\n    if (!url || url.trim() === '') {\n        throw new Error('No url provided');\n    }\n    return new URL(url).pathname;\n}\n\nfunction normalisePath(path, options) {\n\n    checkStructure(path, 'path');\n    var url = new URL('http://example.org' + path);\n    if (endsWith(url.pathname, '/')) {\n        url.pathname = url.pathname.slice(0, -1);\n    }\n    return url.pathname;\n}\n\nfunction normaliseRoute(route) {\n\n    checkStructure(route, 'route');\n    if (endsWith(route, '/')) {\n        route = route.slice(0, -1);\n    }\n    return route;\n}\n\nfunction checkStructure(str, name) {\n\n    if (!str || str.trim() === '') {\n        throw new Error('No ' + name + ' provided');\n    }\n    if (str.indexOf('/') !== 0) {\n        throw new Error('The ' + name + ' does not start with a backslash');\n    }\n}\n\nfunction endsWith(str, match, position) {\n    if (typeof position !== 'number' || !isFinite(position) || Math.floor(position) !== position || position > str.length) {\n        position = str.length;\n    }\n    position -= match.length;\n    var lastIndex = str.lastIndexOf(match, position);\n    return lastIndex !== -1 && lastIndex === position;\n}\n\nCallRouter.urltoPath = urltoPath;\nCallRouter.normaliseRoute = normaliseRoute;\nCallRouter.normalisePath = normalisePath;\n\nreturn CallRouter;\n\n})));\n//# sourceMappingURL=hapi-router.js.map\n","'use strict';\n\nimport Utils from '../utils.js';\nimport HAPIRouter from './router';\n\n\nvar internals = {\n\n    version: '0.1',\n    baseTemplates: [],\n    routes: [],\n    router: new HAPIRouter.Router(),\n    routeKey: 1,\n    routeMap: {},\n\n    injectCommand: function injectCommand(response, command) {\n        var clonedResponse = response.clone();\n\n        if (clonedResponse.status >= 200 && clonedResponse.status < 400) {\n            var options = {\n                status: clonedResponse.status,\n                statusText: clonedResponse.statusText,\n                headers: {\n                    'X-GhostWorker': 'Template',\n                    'Content-Type': 'text/html'\n                }\n            };\n\n            // test status before modification\n            return clonedResponse.text().then(function (body) {\n                return new Response(body + '<script class=\"ghostworker-script\">' + command + '</script>', options);\n            });\n        } else {\n            return response;\n        }\n    },\n\n    // fetch and then cache successful responses\n    // only if 2xx status code is returned and not if its has header X-GhostWorker-Content === raw\n    fetchAndCache: function fetchAndCache(request, options) {\n\n        var self = this;\n        options = options || {};\n        return fetch(request.clone()).then(function (response) {\n            var requestURL = new URL(request.url);\n            // has to a GET with 200 status and not a `raw` request to be caches\n            if (request.method === 'GET' && response.status > 199 && response.status < 400 && request.headers.get('X-GhostWorker-Content') !== 'raw') {\n                caches.open('ghostworker-' + self.getCacheName(response) + '-v' + self.version).then(function (cache) {\n                    cache.put(request, response);\n                });\n            }\n            return response.clone();\n        }).catch(function (reason) {\n            console.log('sw fetch fail', reason);\n        });\n    },\n\n\n    // gets the correct cache based on Content-Type of request\n    getCacheName: function getCacheName(response) {\n\n        var cacheType = 'other';\n        if (response && response.headers) {\n            var name;\n\n            (function () {\n                var contentType = response.headers.get('Content-Type');\n                if (contentType.indexOf(';') > -1) {\n                    contentType = contentType.split(';')[0].trim();\n                }\n\n                if (contentType && contentType.indexOf('/') > -1) {\n                    var parts = contentType.split('/');\n                    switch (parts[0]) {\n                        case 'image':\n                            cacheType = 'image';\n                            break;\n                        case 'audio':\n                            cacheType = 'audio';\n                            break;\n                        case 'video':\n                            cacheType = 'video';\n                            break;\n                        case 'application':\n                            cacheType = 'application';\n                            break;\n                        case 'text':\n                            cacheType = 'text';\n                            break;\n                    }\n\n                    var contentMimeTypes = {\n                        html: ['text/html', 'application/xhtml+xml'],\n                        css: ['text/css'],\n                        js: ['application/javascript', 'text/javascript', 'application/json'],\n                        font: ['application/vnd.ms-fontobject', 'application/font-woff', 'application/font-woff2', 'application/x-font-truetype', 'application/x-font-opentype']\n                    };\n\n                    if (cacheType === 'application' || cacheType === 'text') {\n                        for (name in contentMimeTypes) {\n                            if (contentMimeTypes.hasOwnProperty(name)) {\n                                contentMimeTypes[name].forEach(function (mimeType) {\n                                    if (mimeType === contentType) {\n                                        cacheType = name;\n                                    }\n                                });\n                            }\n                        }\n                    }\n                }\n            })();\n        }\n\n        return cacheType;\n    },\n\n    // creates a simple slug of text for use in urls\n    slugify: function slugify(str) {\n        str = str.replace(/^\\s+|\\s+$/g, ''); // trim\n        str = str.toLowerCase();\n\n        // remove accents, swap ñ for n, etc\n        var from = \"ãàáäâẽèéëêìíïîõòóöôùúüûñç·/_,:;\";\n        var to = \"aaaaaeeeeeiiiiooooouuuunc------\";\n        for (var i = 0, l = from.length; i < l; i++) {\n            str = str.replace(new RegExp(from.charAt(i), 'g'), to.charAt(i));\n        }\n\n        str = str.replace(/[^a-z0-9 -]/g, '') // remove invalid chars\n        .replace(/\\s+/g, '-') // collapse whitespace and replace by -\n        .replace(/-+/g, '-'); // collapse dashes\n\n        return str;\n    },\n\n\n    // gets route data based on paths in routing table and pathMatchFunction\n    getRouteData: function getRouteData(url) {\n\n        var targetUrl = new URL(url);\n        var targetRoute = this.router.route('get', targetUrl.pathname);\n        if (targetRoute) {\n            // use key to get array of matches from routeMap\n            var matchingRoutes = this.routeMap[targetRoute.route];\n\n            if (matchingRoutes.length > 1) {\n                var out = null;\n                matchingRoutes.forEach(function (route) {\n                    if (route.pathMatchFunction && route.pathMatchFunction(targetUrl.pathname, targetRoute)) {\n                        out = route;\n                    }\n                });\n                return out;\n            }\n            if (matchingRoutes.length === 1) {\n                return matchingRoutes[0];\n            }\n        }\n        return null;\n    },\n\n    // checks version number of cache to make sure it still valid\n    isValidCache: function isValidCache(cacheName) {\n        return cacheName.indexOf('ghostworker-') === 0 && Utils.endsWith(cacheName, 'v' + this.version);\n    },\n\n    // external interface for adding site level options\n    addSiteOptions: function addSiteOptions(options) {\n\n        var self = internals;\n        if (options.version) {\n            self.version = options.version;\n        }\n        if (Array.isArray(options.template) === false) {\n            options.template = [options.template];\n        }\n        options.template.forEach(function (template) {\n            if (template.elements.indexOf('title') === -1) {\n                template.elements.unshift('title');\n            }\n            if (!template.templatePath) {\n                if (template.name) {\n                    template.templatePath = '/-base-' + self.slugify(template.name) + '-template';\n                } else {\n                    template.templatePath = '/-base-template';\n                }\n            }\n            self.baseTemplates.push(template);\n        });\n    },\n\n\n    // external interface for adding section level options\n    addSectionOptions: function addSectionOptions(options) {\n\n        var self = internals;\n        var route = options.template;\n\n        if (!options.template.templatePath && options.name) {\n            options.template.templatePath = '/-' + self.slugify(options.name) + '-template';\n        }\n        options.template.slug = self.slugify(options.name);\n        options.template.elements = options.template.elements || [];\n        if (options.template.elements.indexOf('title') === -1) {\n            options.template.elements.unshift('title');\n        }\n\n\n        if (!Array.isArray(options.path)) {\n            options.path = [options.path];\n        }\n        options.path.forEach(function (path) {\n            var path = Utils.removeLastBackslash(path);\n            if (!self.router.route('get', path)) {\n                // add route with key so we can match more than one object\n                self.router.add({ method: 'get', path: path }, self.routeKey);\n                self.routeMap[self.routeKey] = [options];\n                self.routeKey++;\n            } else {\n                self.routeMap[self.router.route('get', path).route].push(options);\n            }\n        });\n    }\n\n};\n\nself.addEventListener('activate', function (event) {\n\n    // delete any caches that have the wrong version number\n    var self = internals;\n    event.waitUntil(caches.keys().then(function (keys) {\n        return Promise.all(keys.map(function (key) {\n            if (!self.isValidCache(key)) {\n                console.log('delete', key);\n                return caches.delete(key);\n            } else {\n                console.log('keep', key);\n            }\n        }));\n    }).then(function () {\n        console.log('GhostWorker activated cache: v' + self.version);\n    }));\n});\n\nself.addEventListener('message', function (event) {\n    //console.log('Handling message event:', event);\n\n    var self = internals;\n    var msgPackage = Utils.clone(event.data);\n    msgPackage.result = {};\n    switch (msgPackage.command) {\n        // This command returns a list of the URLs corresponding to the Request objects\n        // that serve as keys for the current cache.\n        case 'getRouteData':\n            if (msgPackage.url) {\n                (function () {\n                    var routeData = self.getRouteData(msgPackage.url);\n                    // find base template by name\n                    if (routeData.baseTemplate) {\n                        self.baseTemplates.forEach(function (baseTemplate) {\n                            if (baseTemplate.name && baseTemplate.name === routeData.baseTemplate) {\n                                msgPackage.result.baseTemplate = baseTemplate;\n                            }\n                        });\n                    }\n                    //else use first base template\n                    if (!msgPackage.result.baseTemplate) {\n                        self.baseTemplates[0];\n                    }\n                    msgPackage.result.routeData = routeData;\n                    msgPackage.result.version = self.version;\n                })();\n            } else {\n                msgPackage.error = 'No url passed';\n            }\n            break;\n        case 'getSiteData':\n            msgPackage.result.baseTemplates = self.baseTemplates;\n            msgPackage.result.version = self.version;\n            break;\n        case 'getVersion':\n            msgPackage.result = self.version;\n            break;\n        default:\n            // This will be handled by the outer .catch().\n            msgPackage.error = 'Unknown command: ' + msgPackage.command;\n    }\n    event.ports[0].postMessage(Utils.clone(msgPackage));\n\n    // use event.waitUntil(promise); if you call promise\n});\n\n\n\n\nself.addEventListener('fetch', function (event) {\n\n    var self = internals;\n    var requestURL = new URL(Utils.urlRemoveBackslash(event.request.url));\n    var routeData = self.getRouteData(requestURL);\n\n    if (Utils.endsWith(requestURL.pathname, '-json') || Utils.endsWith(requestURL.pathname, '-template')) {\n\n        event.respondWith(caches.match(event.request).then(function (response) {\n            if (response) {\n                return response;\n            }\n            return response;\n        }));\n    } else if (routeData && event.request.headers.get('X-GhostWorker-Content') !== 'raw') {\n\n        // templates\n        var templateRequest = new Request(Utils.urlReplacePath(event.request.url, routeData.template.templatePath), {});\n        event.respondWith(caches.match(templateRequest).then(function (response) {\n\n            // if found response with template and instructions to add JSON\n            if (response) {\n                return self.injectCommand(response, 'GhostWorkerDOM.addJSON();');\n            } else {\n\n                // use real request object\n                return fetch(event.request).then(function (response) {\n                    // with first response add instructions to create template and JSON\n                    return self.injectCommand(response, 'GhostWorkerDOM.create();');\n                }).catch(function (reason) {\n                    console.log('sw fetch fail', reason);\n                });\n            }\n        }));\n    } else {\n        // everthing else\n        event.respondWith(caches.match(event.request).then(function (response) {\n            if (response) {\n                return response;\n            }\n            return self.fetchAndCache(event.request, {});\n        }));\n    }\n});\n\n\n\nvar index = {\n    version: internals.version,\n    site: internals.addSiteOptions,\n    section: internals.addSectionOptions\n};\n\n\n/*\nself.addEventListener('install', listeners.installListener);\nself.addEventListener('activate', listeners.activateListener);\nself.addEventListener('fetch', listeners.fetchListener);\n*/"],"names":["removeLastBackslash","path","endsWith","slice","urlJoinPath","url","URL","pathname","toString","urlReplacePath","urlRemoveBackslash","str","match","position","isFinite","Math","floor","length","lastIndex","lastIndexOf","clone","obj","JSON","parse","stringify","Object","assign","target","undefined","TypeError","output","index","arguments","source","nextKey","hasOwnProperty","handleErrors","response","ok","Error","statusText","exports","global","factory","module","define","amd","HAPIRouter","this","interopDefault","ex","createCommonjsModule","fn","hoek","applyToDefaults","src","key","escapeRegex","string","replace","assert","condition","message","hoek$1","require$$0","freeze","boom","notFound","badRequest","boom$1","require$$2","regex","internals","generate","empty","legalChars","encoded","literalChar","literal","literalOptional","midParam","endParam","partialParam","mixedParam","segmentContent","segment","segments","parseParam","expressions","RegExp","regex$1","require$$1","Hoek","Segment","_edge","_fulls","_literals","_param","_mixed","_wildcard","prototype","add","record","current","remaining","isEdge","literals","isLiteral","i","push","join","settings","isCaseSensitive","toLowerCase","currentLiteral","wildcard","mixed","_mixedLookup","node","sort","a","b","aFirst","bFirst","as","bs","first","am","bm","lookup","options","array","nextPath","remainder","deeper","params","j","_record","_record2","result","concat","segment$1","require$$0$1","Boom","Regex","Router","defaults","routes","ids","vhosts","specials","config","route","method","vhost","table","router","analysis","analyze","fingerprint","last","id","special","type","keys","indexOf","hostname","split","_lookup","set","assignments","name","value","decode","isBoom","paramsArray","decodeURIComponent","err","normalize","uppercase","toUpperCase","decoded","String","fromCharCode","parseInt","substring","pathRegex","validatePath","test","validatePathEncoded","pathParts","fingers","parts","parseParams","item","wilcard","count","seg","finger","_j","part","host","collect","forEach","CallRouter","urltoPath","trim","normalisePath","normaliseRoute","checkStructure","injectCommand","command","clonedResponse","status","text","then","body","Response","fetchAndCache","request","self","fetch","requestURL","headers","get","open","getCacheName","version","cache","put","catch","reason","log","cacheType","contentType","contentMimeTypes","mimeType","slugify","from","to","l","charAt","getRouteData","targetUrl","targetRoute","matchingRoutes","routeMap","out","pathMatchFunction","isValidCache","cacheName","Utils","addSiteOptions","Array","isArray","template","elements","unshift","templatePath","baseTemplates","addSectionOptions","slug","routeKey","addEventListener","event","waitUntil","caches","Promise","all","map","delete","msgPackage","data","routeData","baseTemplate","error","ports","postMessage","respondWith","templateRequest","Request"],"mappings":"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"}